<!DOCTYPE html>
<!-- 
    Governed by THE LANE‚Ñ¢ Doctrine v1.0 ‚Äî December 2024
    Any change must pass the Doctrine Test.
    No gamification. No motivation. No engagement tricks.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE LANE‚Ñ¢ ‚Äî 2026 Edition</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ§Ô∏è</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #0d1117;
            --accent: #00d4aa;
            --accent-dim: rgba(0, 212, 170, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            --card-bg: rgba(255, 255, 255, 0.03);
            --card-border: rgba(255, 255, 255, 0.05);
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
        }
        
        .light-mode {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --card-bg: rgba(0, 0, 0, 0.02);
            --card-border: rgba(0, 0, 0, 0.08);
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        h1 { font-size: 2.5rem; font-weight: 800; line-height: 1.2; }
        h2 { font-size: 1.875rem; font-weight: 700; line-height: 1.3; }
        h3 { font-size: 1.25rem; font-weight: 600; }
        h4 { font-size: 1rem; font-weight: 600; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
        .hidden { display: none !important; }
        
        .card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.5rem;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }
        
        .btn-primary {
            background: var(--accent);
            color: #000;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 212, 170, 0.4);
        }
        
        .btn-secondary {
            background: transparent;
            border: 1px solid var(--card-border);
            color: var(--text-primary);
        }
        
        .btn-secondary:hover {
            background: var(--card-bg);
            border-color: var(--accent);
        }
        
        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }
        
        .btn-ghost:hover {
            color: var(--accent);
        }
        
        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
        }
        
        .btn-danger {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }
        
        .btn-danger:hover {
            background: rgba(239, 68, 68, 0.3);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        textarea { resize: vertical; min-height: 100px; }
        
        label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .form-group { margin-bottom: 1.5rem; }
        .form-hint { font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        
        .ceo-line {
            border-left: 3px solid var(--accent);
            padding: 1rem 1.25rem;
            background: var(--accent-dim);
            border-radius: 0 0.5rem 0.5rem 0;
            font-style: italic;
            color: var(--text-secondary);
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--card-border);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 3px;
            transition: width 0.3s;
        }
        
        .pill {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .pill-success { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .pill-danger { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .pill-warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .pill-neutral { background: var(--card-bg); color: var(--text-secondary); }
        
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--card-border);
        }
        
        .light-mode .header {
            background: rgba(255, 255, 255, 0.9);
        }
        
        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 800;
            font-size: 1.25rem;
        }
        
        .logo-icon {
            width: 2rem;
            height: 2rem;
            background: var(--accent);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .theme-toggle, .export-btn {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
        }
        
        .export-btn:hover, .theme-toggle:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .tab-nav {
            display: flex;
            gap: 0.25rem;
            padding: 0 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
            overflow-x: auto;
        }
        
        .tab-btn {
            padding: 0.75rem 1.25rem;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            white-space: nowrap;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab-btn:hover {
            color: var(--text-secondary);
        }
        
        .tab-btn.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }
        
        .tab-content {
            padding: 2rem 0 4rem;
        }
        
        /* ==================== WEEKLY SCORECARD STYLES ==================== */
        .scorecard-hero {
            text-align: center;
            padding: 1rem 0 2rem;
        }
        
        .week-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .week-selector button {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-secondary);
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.25rem;
        }
        
        .week-selector button:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .week-label {
            font-size: 1.25rem;
            font-weight: 600;
            min-width: 200px;
        }
        
        .scorecard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .scorecard-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.5rem;
        }
        
        .scorecard-card h4 {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .metric-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--card-border);
        }
        
        .metric-row:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .metric-input {
            width: 80px;
            text-align: center;
            padding: 0.5rem;
        }
        
        .check-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .check-row:hover {
            background: var(--card-bg);
        }
        
        .check-row.completed {
            background: var(--accent-dim);
        }
        
        .check-row input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            cursor: pointer;
            pointer-events: none;
        }
        
        .check-row label {
            margin: 0;
            cursor: pointer;
            flex: 1;
        }
        
        /* ==================== PIPELINE STYLES ==================== */
        .pipeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .pipeline-stats {
            display: flex;
            gap: 2rem;
        }
        
        .pipeline-stat {
            text-align: center;
        }
        
        .pipeline-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .pipeline-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        
        .pipeline-stages {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
        }
        
        .pipeline-stage {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1rem;
            min-height: 300px;
        }
        
        .stage-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--card-border);
        }
        
        .stage-title {
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .stage-count {
            background: var(--accent-dim);
            color: var(--accent);
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .stage-add {
            background: transparent;
            border: 1px dashed var(--card-border);
            border-radius: 0.5rem;
            padding: 0.5rem;
            color: var(--text-muted);
            cursor: pointer;
            width: 100%;
            font-size: 0.75rem;
            margin-top: 0.5rem;
        }
        
        .stage-add:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .deal-card {
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .deal-card:hover {
            border-color: var(--accent);
        }
        
        .deal-name {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }
        
        .deal-meta {
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
        }
        
        .deal-gci {
            color: var(--success);
            font-weight: 600;
        }
        
        /* ==================== 90-DAY REVIEW STYLES ==================== */
        .sprint-selector {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }
        
        .sprint-btn {
            padding: 0.75rem 1.5rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            color: var(--text-muted);
            cursor: pointer;
            font-weight: 600;
            position: relative;
        }
        
        .sprint-btn:hover {
            border-color: var(--text-muted);
        }
        
        .sprint-btn.active {
            background: var(--accent-dim);
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .sprint-btn.completed {
            border-color: var(--text-muted);
            color: var(--text-muted);
        }
        
        .sprint-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .sprint-section-title {
            font-weight: 600;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }
        
        .review-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }
        
        .review-column-title {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            text-align: center;
        }
        
        .review-column-title.stop { color: var(--danger); }
        .review-column-title.start { color: var(--success); }
        .review-column-title.continue { color: #3b82f6; }
        
        /* ==================== GCI TRACKER STYLES ==================== */
        .gci-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .gci-summary-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.25rem;
            text-align: center;
        }
        
        .gci-summary-value {
            font-size: 1.75rem;
            font-weight: 800;
        }
        
        .gci-summary-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 0.25rem;
        }
        
        .gci-months {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1rem;
        }
        
        .gci-month-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.25rem;
        }
        
        .gci-month-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .gci-month-name {
            font-weight: 600;
        }
        
        .gci-month-progress {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
        }
        
        .gci-month-progress.on-track {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .gci-month-progress.behind {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }
        
        .gci-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }
        
        .gci-row label {
            min-width: 60px;
            font-size: 0.75rem;
            margin: 0;
        }
        
        .gci-row input {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.875rem;
        }
        
        /* ==================== VISIBILITY PLANNER STYLES ==================== */
        .visibility-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .visibility-month-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .visibility-month-selector button {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-secondary);
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
        }
        
        .visibility-month-selector button:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .visibility-month-label {
            font-size: 1.25rem;
            font-weight: 600;
            min-width: 150px;
            text-align: center;
        }
        
        .visibility-stats {
            display: flex;
            gap: 1.5rem;
        }
        
        .visibility-stat {
            text-align: center;
        }
        
        .visibility-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .visibility-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        
        .visibility-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }
        
        .calendar-header {
            text-align: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            padding: 0.5rem;
        }
        
        .calendar-day {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            min-height: 80px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendar-day:hover {
            border-color: var(--accent);
        }
        
        .calendar-day.empty {
            background: transparent;
            border: none;
            cursor: default;
        }
        
        .calendar-day.completed {
            background: var(--bg-secondary);
        }
        
        .calendar-day-number {
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .calendar-day-action {
            font-size: 0.625rem;
            color: var(--text-muted);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .calendar-day.completed .calendar-day-action {
            color: var(--text-secondary);
        }
        
        /* ==================== SHARE MODAL STYLES ==================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }
        
        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            border-bottom: 1px solid var(--card-border);
        }
        
        .modal-header h3 {
            font-size: 1.25rem;
        }
        
        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
            padding: 1.5rem;
            border-top: 1px solid var(--card-border);
        }
        
        .share-preview {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.75rem;
            padding: 1.25rem;
            font-family: monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        /* ==================== DATABASE HEALTH METER ==================== */
        .db-health-section {
            border-top: 1px solid var(--card-border);
            margin-top: 1rem;
            padding-top: 1rem;
        }
        
        .db-meter {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 0.75rem;
        }
        
        .db-meter-bar {
            flex: 1;
            height: 12px;
            background: var(--card-border);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .db-meter-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.3s, background-color 0.3s;
        }
        
        .db-meter-fill.success { background: var(--success); }
        .db-meter-fill.warning { background: var(--warning); }
        .db-meter-fill.danger { background: var(--danger); }
        
        .db-meter-label {
            font-weight: 600;
            min-width: 60px;
            text-align: right;
        }
        
        /* ==================== ADDITIONAL STYLES ==================== */
        .onboarding {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .onboarding-card {
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        
        .onboarding-step { display: none; }
        .onboarding-step.active { display: block; }
        
        .onboarding h1 { margin-bottom: 0.5rem; }
        .onboarding .subtitle { color: var(--text-secondary); margin-bottom: 2rem; }
        
        .lane-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin: 1.5rem 0;
        }
        
        .lane-option {
            padding: 1rem;
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .lane-option:hover { border-color: var(--text-muted); }
        .lane-option.selected { border-color: var(--accent); background: var(--accent-dim); }
        .lane-option input { display: none; }
        
        .command-hero {
            text-align: center;
            padding: 2rem 0 1rem;
        }
        
        .command-hero h1 { font-size: 1.5rem; margin-bottom: 0.25rem; }
        .command-question { color: var(--text-muted); font-size: 0.875rem; }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .status-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.25rem;
            text-align: center;
        }
        
        .status-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .status-value { font-size: 2rem; font-weight: 800; }
        .status-subtext { font-size: 0.75rem; color: var(--text-secondary); }
        
        .action-card {
            background: var(--accent-dim);
            border: 1px solid var(--accent);
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .action-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .action-text { font-size: 1.125rem; font-weight: 500; }
        
        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .nav-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.25rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .nav-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }
        
        .nav-card-icon { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .nav-card-title { font-weight: 600; font-size: 0.875rem; margin-bottom: 0.25rem; }
        .nav-card-status { font-size: 0.75rem; color: var(--text-muted); }
        
        .quick-ref {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            padding: 1.25rem;
            margin: 1.5rem 0;
        }
        
        .quick-ref-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .quick-ref-title { font-size: 0.875rem; font-weight: 600; }
        .quick-ref-grid { display: grid; gap: 0.5rem; font-size: 0.875rem; }
        
        .quick-ref-row {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
        }
        
        .quick-ref-label { color: var(--text-muted); }
        .quick-ref-value { font-weight: 500; }
        
        .system-notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10000;
            max-width: 300px;
        }
        
        .system-notification.visible { opacity: 1; }
        
        /* Year Position */
        .year-progress {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.75rem;
            padding: 0.75rem 1.25rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .year-progress-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        /* Week Status Banner */
        .week-complete-banner {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
            margin-bottom: 1rem;
        }
        
        .builder-step { display: none; }
        .builder-step.active { display: block; }
        
        .builder-progress {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }
        
        .builder-progress-fill {
            flex: 1;
            height: 4px;
            background: var(--card-border);
            border-radius: 2px;
        }
        
        .builder-progress-fill-inner {
            height: 100%;
            background: var(--accent);
            border-radius: 2px;
            transition: width 0.3s;
        }
        
        .builder-progress-text {
            font-size: 0.75rem;
            color: var(--text-muted);
            white-space: nowrap;
        }
        
        .builder-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--card-border);
        }
        
        .decision-grid {
            display: grid;
            gap: 0.75rem;
        }
        
        .decision-option {
            padding: 0.75rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .decision-option:hover { border-color: var(--text-muted); }
        .decision-option.selected { border-color: var(--accent); background: var(--accent-dim); }
        .decision-option input { display: none; }
        
        .month-tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 0.25rem 0;
            margin-bottom: 1.5rem;
        }
        
        .month-tab {
            padding: 0.5rem 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            color: var(--text-muted);
            cursor: pointer;
            white-space: nowrap;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        
        .month-tab:hover { border-color: var(--text-muted); }
        .month-tab.active { background: var(--accent-dim); border-color: var(--accent); color: var(--accent); }
        .month-tab.completed { color: var(--text-muted); }
        
        .standard-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            margin-bottom: 1rem;
            overflow: hidden;
        }
        
        .standard-card.complete { border-color: var(--success); }
        
        .standard-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.25rem;
            cursor: pointer;
        }
        
        .standard-title { display: flex; align-items: center; gap: 1rem; }
        
        .standard-number {
            width: 2rem;
            height: 2rem;
            background: var(--card-border);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .standard-card.complete .standard-number { background: var(--text-muted); color: white; }
        
        .standard-content {
            display: none;
            padding: 0 1.25rem 1.25rem;
            border-top: 1px solid var(--card-border);
        }
        
        .standard-card.open .standard-content { display: block; }
        .standard-truth { font-style: italic; color: var(--text-muted); margin: 1rem 0; }
        .checklist { display: grid; gap: 0.5rem; }
        
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: 0.375rem;
            cursor: pointer;
        }
        
        .checklist-item:hover { background: var(--card-bg); }
        .checklist-item.checked { color: var(--success); }
        .checklist-item.checked label { text-decoration: line-through; opacity: 0.7; }
        .checklist-item input { width: auto; cursor: pointer; }
        .checklist-item label { cursor: pointer; font-size: 0.875rem; }
        
        .prompt-category { margin-bottom: 2rem; }
        .prompt-category-title { font-weight: 600; margin-bottom: 1rem; font-size: 1.125rem; }
        
        .prompt-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 0.75rem;
            margin-bottom: 0.75rem;
            overflow: hidden;
        }
        
        .prompt-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.25rem;
            cursor: pointer;
        }
        
        .prompt-title { font-weight: 500; font-size: 0.875rem; }
        .prompt-toggle { color: var(--text-muted); transition: transform 0.2s; }
        .prompt-card.open .prompt-toggle { transform: rotate(180deg); }
        
        .prompt-content {
            display: none;
            padding: 0 1.25rem 1.25rem;
            border-top: 1px solid var(--card-border);
        }
        
        .prompt-card.open .prompt-content { display: block; }
        
        .prompt-text {
            background: var(--bg-primary);
            border: 1px solid var(--card-border);
            border-radius: 0.5rem;
            padding: 1rem;
            font-size: 0.875rem;
            margin: 1rem 0;
            white-space: pre-wrap;
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.75rem; }
            h2 { font-size: 1.5rem; }
            .header-inner { flex-wrap: wrap; gap: 0.75rem; }
            .tab-nav { padding: 0 1rem; }
            .tab-btn { padding: 0.75rem 0.75rem; font-size: 0.75rem; }
            .status-grid { grid-template-columns: repeat(2, 1fr); }
            .lane-grid { grid-template-columns: 1fr; }
            .pipeline-stages { grid-template-columns: 1fr; }
            .review-grid { grid-template-columns: 1fr; }
            .visibility-calendar { grid-template-columns: repeat(7, 1fr); }
            .calendar-day { min-height: 50px; padding: 0.5rem; }
            .calendar-day-action { display: none; }
        }
        
        @media print {
            .header, .tab-nav, .btn, .modal-overlay { display: none !important; }
            .tab-content { display: block !important; padding: 0; }
            .container { max-width: none; }
            body { background: white; color: black; }
            .card, .scorecard-card, .sprint-section, .gci-month-card { 
                break-inside: avoid; 
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <div id="systemNotification" class="system-notification"></div>

    <!-- ==================== ONBOARDING ==================== -->
    <div id="onboarding" class="onboarding">
        <div class="onboarding-card">
            <!-- Onboarding Progress (hidden on step 1, visible steps 2-8) -->
            <div id="onboardingProgress" style="display: none; margin-bottom: 1.5rem; text-align: center;">
                <div style="background: var(--card-bg); border-radius: 1rem; height: 6px; overflow: hidden; margin-bottom: 0.5rem;">
                    <div id="onboardingProgressFill" style="background: var(--accent); height: 100%; width: 12.5%; transition: width 0.3s ease;"></div>
                </div>
                <span id="onboardingProgressText" style="font-size: 0.75rem; color: var(--text-muted);">Step 1 of 8 ‚Ä¢ ~4 minutes remaining</span>
            </div>
            <div class="onboarding-step active" data-step="1">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö°</div>
                <h1>THE LANE‚Ñ¢ 2026</h1>
                <p class="subtitle">The Operating System for Predictable Income</p>
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 1.5rem 0; line-height: 1.6;">
                    You've bought the planners. Hired the coaches. Tried the scripts.<br>
                    And you're still starting over every quarter.<br>
                    <span style="color: var(--text-primary);">That's not a discipline problem ‚Äî it's a system problem.</span>
                </p>
                <div style="background: var(--bg-secondary); border: 1px solid var(--border); padding: 1.25rem 1.5rem; border-radius: 0.5rem; margin: 1.5rem 0; text-align: center;">
                    <div style="font-size: 1.125rem; font-weight: 600; color: var(--text-primary);">You always know what to do next.</div>
                </div>
                <button class="btn btn-primary" onclick="nextOnboardingStep()" style="margin-top: 1.5rem;">Begin Setup ‚Üí</button>
            </div>

            <div class="onboarding-step" data-step="2">
                <h2>Is This For You?</h2>
                <p class="subtitle">This OS is opinionated. It works because it removes alternatives.</p>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin: 2rem 0; text-align: left;">
                    <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success); border-radius: 0.75rem; padding: 1.25rem;">
                        <h4 style="margin-bottom: 0.75rem;">This IS For You If:</h4>
                        <ul style="font-size: 0.875rem; color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 0.5rem;">
                            <li>‚Ä¢ You want fewer strategies, not more</li>
                            <li>‚Ä¢ You're willing to repeat boring actions</li>
                            <li>‚Ä¢ Motivation is unreliable. Systems are not.</li>
                            <li>‚Ä¢ You're done starting over every quarter</li>
                        </ul>
                    </div>
                    <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); border-radius: 0.75rem; padding: 1.25rem;">
                        <h4 style="color: var(--danger); margin-bottom: 0.75rem;">‚úó This is NOT For You If:</h4>
                        <ul style="font-size: 0.875rem; color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 0.5rem;">
                            <li>‚Ä¢ You want inspiration instead of execution</li>
                            <li>‚Ä¢ You change direction weekly</li>
                            <li>‚Ä¢ You want someone else to do the work</li>
                            <li>‚Ä¢ You're looking for a pretty planner</li>
                        </ul>
                    </div>
                </div>
                <p style="font-size: 0.8rem; color: var(--text-muted); text-align: center; margin: 1rem 0; font-style: italic;">This system is calm on purpose. Calm systems outlast emotional ones.</p>
                <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin-bottom: 1rem;">This system trades optionality for momentum.</p>
                <div style="display: flex; gap: 0.75rem; justify-content: center;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">I'm Ready ‚Üí</button>
                </div>
            </div>

            <div class="onboarding-step" data-step="3">
                <h2>Let's start with you</h2>
                <p class="subtitle">This personalizes your entire operating system.</p>
                <div style="text-align: left; margin: 2rem 0;">
                    <div class="form-group">
                        <label>Your Name</label>
                        <input type="text" id="ob_name" placeholder="What should we call you?">
                    </div>
                    <div class="form-group">
                        <label>Your 2026 Income Goal</label>
                        <input type="text" id="ob_income_goal" placeholder="e.g., $150,000">
                        <p class="form-hint">Be honest. This becomes your math baseline.</p>
                    </div>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: center;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue ‚Üí</button>
                </div>
            </div>

            <div class="onboarding-step" data-step="4">
                <h2>Choose Your Lane</h2>
                <p class="subtitle">Pick ONE focus for the next 90 days.</p>
                <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0.5rem 0 0.5rem; font-style: italic;">If you're unsure, choose the lane that already brings you the most conversations ‚Äî not the one you wish would.</p>
                <p style="font-size: 0.75rem; color: var(--text-muted); margin: 0 0 1rem;">Examples: Open Houses ‚Ä¢ Past Clients ‚Ä¢ Agent Referrals ‚Ä¢ Content ‚Üí DMs ‚Ä¢ Geographic Farm</p>
                <div class="lane-grid" style="grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); max-width: 700px; margin: 0 auto;">
                    <label class="lane-option"><input type="radio" name="lane" value="Listings"><div>üìã Listings</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Buyers"><div>üè† Buyers</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="First-Time Buyers"><div>üå± First-Time Buyers</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Investors"><div>üìà Investors</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Luxury"><div>üè∞ Luxury</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="New Construction"><div>üèóÔ∏è New Construction</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Relocation"><div>‚úàÔ∏è Relocation</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Downsizing"><div>üì¶ Downsizing</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="55+ Seniors"><div>üë¥ 55+ Seniors</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="VA/Military"><div>üéñÔ∏è VA/Military</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Geographic Farm"><div>üìç Geographic Farm</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Sphere & Referrals"><div>ü§ù Sphere & Referrals</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Expired/FSBOs"><div>üì¨ Expired/FSBOs</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Probate/Estate"><div>‚öñÔ∏è Probate/Estate</div></label>
                    <label class="lane-option"><input type="radio" name="lane" value="Other"><div>‚úèÔ∏è Other</div></label>
                </div>
                <div id="otherLaneInput" style="display: none; margin-top: 1rem;">
                    <input type="text" id="customLaneName" placeholder="Describe your lead generation lane..." style="width: 100%; max-width: 400px; padding: 0.75rem 1rem; border: 1px solid var(--card-border); border-radius: 0.5rem; background: var(--bg); color: var(--text-primary); font-size: 1rem;">
                </div>
                <div style="margin-top: 1.5rem; max-width: 500px; margin-left: auto; margin-right: auto;">
                    <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">In one sentence, why this lane?</label>
                    <input type="text" id="ob_lane_why" placeholder="e.g., Most of my deals last year came from..." style="width: 100%; padding: 0.75rem 1rem; border: 1px solid var(--card-border); border-radius: 0.5rem; background: var(--bg); color: var(--text-primary); font-size: 0.9rem;">
                    <p style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.25rem; font-style: italic;">This appears when you doubt your choice.</p>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: center; margin-top: 1.5rem;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue ‚Üí</button>
                </div>
            </div>

            <div class="onboarding-step" data-step="5">
                <h2>Your Experience Level</h2>
                <p class="subtitle">Calibration happens here.</p>
                <div class="lane-grid">
                    <label class="lane-option"><input type="radio" name="experience" value="New"><div>üå± New (0-2 years)</div></label>
                    <label class="lane-option"><input type="radio" name="experience" value="Growing"><div>üìà Growing (2-5 years)</div></label>
                    <label class="lane-option"><input type="radio" name="experience" value="Established"><div>‚≠ê Established (5+ years)</div></label>
                    <label class="lane-option"><input type="radio" name="experience" value="Top Producer"><div>üèÜ Top Producer</div></label>
                </div>
                <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin: 1rem 0;">Experience changes pace‚Äînot principles.</p>
                <div style="display: flex; gap: 0.75rem; justify-content: center;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue ‚Üí</button>
                </div>
            </div>

            <div class="onboarding-step" data-step="6">
                <h2>If This System Works</h2>
                <p class="subtitle">Paint the picture. Make it real.</p>
                <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem; font-style: italic;">Write honestly, not perfectly. You can refine this later.</p>
                <div style="text-align: left; margin: 2rem 0;">
                    <div class="form-group">
                        <label>If I follow this OS for 12 months, what is different about my days?</label>
                        <textarea id="ob_vision_days" placeholder="Describe your ideal day when this is working..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>What stress disappears first?</label>
                        <textarea id="ob_vision_stress" placeholder="What worries go away when income becomes predictable?"></textarea>
                    </div>
                    <div class="form-group">
                        <label>What stays intentionally small?</label>
                        <textarea id="ob_vision_small" placeholder="What do you NOT want to scale? What boundaries matter?"></textarea>
                    </div>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: center;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">Continue ‚Üí</button>
                </div>
            </div>

            <div class="onboarding-step" data-step="7">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚úçÔ∏è</div>
                <h2>Before You Begin</h2>
                <p class="subtitle">This works because the decision has already been made.</p>
                <div style="background: var(--card-bg); border: 2px solid var(--accent); border-radius: 1rem; padding: 1.5rem; margin: 2rem 0; text-align: left;">
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <label style="display: flex; align-items: flex-start; gap: 0.75rem; cursor: pointer;">
                            <input type="checkbox" id="commit1" style="width: 20px; height: 20px; margin-top: 2px; accent-color: var(--accent);">
                            <span><strong>I commit to one lane for 90 days.</strong><br><span style="color: var(--text-muted); font-size: 0.85rem;">No switching. No adding. One focus.</span></span>
                        </label>
                        <label style="display: flex; align-items: flex-start; gap: 0.75rem; cursor: pointer;">
                            <input type="checkbox" id="commit2" style="width: 20px; height: 20px; margin-top: 2px; accent-color: var(--accent);">
                            <span><strong>I commit to repetition over innovation.</strong><br><span style="color: var(--text-muted); font-size: 0.85rem;">Boring works. New doesn't.</span></span>
                        </label>
                        <label style="display: flex; align-items: flex-start; gap: 0.75rem; cursor: pointer;">
                            <input type="checkbox" id="commit3" style="width: 20px; height: 20px; margin-top: 2px; accent-color: var(--accent);">
                            <span><strong>I commit to finishing weeks, not chasing outcomes.</strong><br><span style="color: var(--text-muted); font-size: 0.85rem;">Execute first. Evaluate later.</span></span>
                        </label>
                    </div>
                    <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--card-border);">
                        <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                            <div style="flex: 1; min-width: 200px;">
                                <label style="font-size: 0.75rem; color: var(--text-muted);">Signed</label>
                                <input type="text" id="commitSignature" placeholder="Your name" style="width: 100%; padding: 0.5rem; border: 1px solid var(--card-border); border-radius: 0.375rem; background: var(--bg); color: var(--text-primary); font-style: italic;">
                            </div>
                            <div>
                                <label style="font-size: 0.75rem; color: var(--text-muted);">Date</label>
                                <div style="padding: 0.5rem; color: var(--text-secondary);" id="commitDate"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: center;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextOnboardingStep()">I Commit ‚Üí</button>
                </div>
            </div>

            <div class="onboarding-step" data-step="8">
                <h2>Setup Complete</h2>
                <p class="subtitle">The system is ready.</p>
                <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 1rem; padding: 1.5rem; margin: 1.5rem 0; text-align: left;">
                    <h4 style="margin-bottom: 1rem;">Configuration:</h4>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem; color: var(--text-secondary);">
                        <div>Name: <span id="confirmName" style="color: var(--text-primary);">‚Äî</span></div>
                        <div>Income Goal: <span id="confirmGoal" style="color: var(--text-primary);">‚Äî</span></div>
                        <div>Lane: <span id="confirmLane" style="color: var(--text-primary);">‚Äî</span></div>
                        <div>Experience: <span id="confirmExperience" style="color: var(--text-primary);">‚Äî</span></div>
                    </div>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: center; margin-top: 1.5rem;">
                    <button class="btn btn-secondary" onclick="prevOnboardingStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="completeOnboarding()">Enter Command Center ‚Üí</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MAIN APP ==================== -->
    <div id="mainApp" class="hidden">
        <header class="header">
            <div class="header-inner">
                <div class="logo">
                    <div class="logo-icon">‚ö°</div>
                    <span>THE LANE <span id="currentYear">2026</span></span>
                </div>
                <div class="header-actions">
                    <button class="export-btn" onclick="exportBackup()" title="Backup Data (Download)">üíæ</button>
                    <button class="export-btn" onclick="document.getElementById('importFile').click()" title="Restore Data (Upload)">üìÇ</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importBackup(event)">
                    <button class="export-btn" onclick="showShareModal()" title="Share Accountability Report">üì§</button>
                    <button class="export-btn" onclick="exportToPDF()" title="Export to PDF">üìÑ</button>
                    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">üåô</button>
                </div>
            </div>
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="command">Command</button>
                <button class="tab-btn" data-tab="weekly">Weekly</button>
                <button class="tab-btn" data-tab="pipeline">Pipeline</button>
                <button class="tab-btn" data-tab="gci">GCI</button>
                <button class="tab-btn" data-tab="visibility">Visibility</button>
                <button class="tab-btn" data-tab="activity">Execution</button>
                <button class="tab-btn" data-tab="review">Quarterly Review</button>
                <button class="tab-btn" data-tab="build">Build</button>
                <button class="tab-btn" data-tab="track">Track</button>
                <button class="tab-btn" data-tab="audit">Audit</button>
                <button class="tab-btn" data-tab="prompts">Prompts</button>
            </nav>
        </header>

        <!-- Identity Anchor (shows across all tabs) -->
        <div id="identityBar" style="background: var(--bg-secondary); border-bottom: 1px solid var(--card-border); padding: 0.5rem 1.5rem; display: none;">
            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: center; gap: 2rem; font-size: 0.75rem; color: var(--text-muted); flex-wrap: wrap;">
                <span>Lane: <strong id="idLane" style="color: var(--accent);">‚Äî</strong></span>
                <span>Calm Number: <strong id="idCalmNumber">‚Äî</strong>/week</span>
                <span>Week: <strong id="idWeekOf">‚Äî</strong></span>
            </div>
        </div>

        <!-- ==================== COMMAND CENTER ==================== -->
        <div id="tab-command" class="tab-content">
            <div class="container">
                <div class="command-hero">
                    <h1>Welcome back, <span id="userName">Agent</span></h1>
                    <p class="command-question">Is this working?</p>
                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">Right now, the only thing that matters is this week's execution.</p>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">You only live in two places weekly: <strong style="color: var(--text-secondary);">Command</strong> and <strong style="color: var(--text-secondary);">Weekly</strong>. Everything else is reference or review.</p>
                </div>

                <!-- Year Position -->
                <div class="year-progress">
                    <span class="year-progress-label">Week <span id="currentWeekNumber">1</span> of 52</span>
                </div>

                <!-- Week Complete Banner (shown when current week scorecard is done) -->
                <div id="weekCompleteBanner" class="week-complete-banner" style="display: none;">
                    Week closed. No further action required.
                </div>

                <!-- Week 1 Banner (shown only first 7 days) -->
                <div id="week1ReassuranceBanner" style="display: none; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 0.5rem; padding: 1rem 1.25rem; margin-bottom: 1.5rem; text-align: center;">
                    <p style="margin: 0; color: var(--text-secondary); font-size: 0.85rem;">
                        <strong>Week 1:</strong> Complete the scorecard. Income lag is expected.
                    </p>
                </div>

                <!-- Welcome Back Banner (shown once after 14+ day absence) -->
                <div id="welcomeBackBanner" style="display: none; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 0.5rem; padding: 1rem 1.25rem; margin-bottom: 1.5rem; text-align: center;">
                    <p style="margin: 0; color: var(--text-secondary); font-size: 0.85rem;">
                        <strong>Welcome back.</strong> The system doesn't judge gaps. Start with this week.
                    </p>
                    <button onclick="dismissWelcomeBack()" style="margin-top: 0.75rem; background: transparent; border: 1px solid var(--border); color: var(--text-secondary); padding: 0.35rem 1rem; border-radius: 0.25rem; cursor: pointer; font-size: 0.8rem;">Continue</button>
                </div>

                <!-- CEO Summary (executive snapshot) -->
                <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 0.75rem; padding: 1rem 1.5rem; margin-bottom: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                        <div style="font-size: 0.8rem; color: var(--text-muted);">
                            <strong style="color: var(--text-secondary);">This Week</strong>
                        </div>
                        <div style="display: flex; gap: 2rem; flex-wrap: wrap; font-size: 0.85rem;">
                            <div><span style="color: var(--text-muted);">Lane:</span> <strong id="ceoLane" style="color: var(--accent);">‚Äî</strong></div>
                            <div><span style="color: var(--text-muted);">Target:</span> <strong id="ceoCalmNumber">‚Äî</strong></div>
                            <div><span style="color: var(--text-muted);">Logged:</span> <strong id="ceoLogged">0</strong></div>
                            <div id="ceoStatus" style="padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.75rem; font-weight: 600;">‚Äî</div>
                        </div>
                    </div>
                </div>

                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-label">Calm Number</div>
                        <div class="status-value" style="color: var(--accent);" id="displayCalmNumber">‚Äî</div>
                        <div class="status-subtext">conversations/week</div>
                        <div style="font-size: 0.65rem; color: var(--text-muted); margin-top: 0.5rem;">Exceeding is optional. Meeting is sufficient.</div>
                        <div style="font-size: 0.6rem; color: var(--text-muted); margin-top: 0.25rem;">When met, no additional activity is required.</div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">This Week</div>
                        <div class="status-value" id="displayThisWeek">‚Äî</div>
                        <div class="status-subtext">of target</div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">Weeks</div>
                        <div class="status-value" id="displayWeeksCompleted">0</div>
                        <div class="status-subtext">closed this year</div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">Pipeline</div>
                        <div class="status-value" id="displayPipelineCount">0</div>
                        <div class="status-subtext" id="displayPipelineGCI">$0 projected</div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">YTD GCI</div>
                        <div class="status-value" style="color: var(--success);" id="displayYTDGCI">$0</div>
                        <div class="status-subtext" id="displayGCIProgress">of goal</div>
                    </div>
                </div>

                <div class="action-card">
                    <div class="action-label">‚Üí Next Action</div>
                    <div class="action-text" id="recommendedAction">Complete your Plan Builder to activate your Command Center.</div>
                </div>

                <div class="quick-ref">
                    <div class="quick-ref-header">
                        <div class="quick-ref-title">Quick Reference</div>
                    </div>
                    <div class="quick-ref-grid">
                        <div class="quick-ref-row"><span class="quick-ref-label">Lane Focus:</span><span class="quick-ref-value" id="qrLane">‚Äî</span></div>
                        <div class="quick-ref-row"><span class="quick-ref-label">Calm Number:</span><span class="quick-ref-value" id="qrCalmNumber">‚Äî</span></div>
                        <div class="quick-ref-row"><span class="quick-ref-label">CEO Hour:</span><span class="quick-ref-value" id="qrCeoHour">‚Äî</span></div>
                        <div class="quick-ref-row"><span class="quick-ref-label">30-Day Focus:</span><span class="quick-ref-value" id="qr30DayFocus">‚Äî</span></div>
                    </div>
                </div>

                <!-- TIME COMMITMENT PROMISE -->
                <div style="display: flex; justify-content: center; gap: 2rem; margin: 1.5rem 0; flex-wrap: wrap;">
                    <div style="text-align: center; padding: 1rem;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent);">15 min</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">Weekly planning</div>
                    </div>
                    <div style="text-align: center; padding: 1rem;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--text-secondary);">0 min</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">Daily decisions</div>
                    </div>
                    <div style="text-align: center; padding: 1rem;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">60 min</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">Quarterly review</div>
                    </div>
                </div>

                <!-- THE LANE LOOP -->
                <div class="card" style="margin-bottom: 1.5rem; text-align: center;">
                    <h4 style="margin-bottom: 1rem; color: var(--text-secondary);">THE LANE Loop</h4>
                    <div style="display: flex; justify-content: center; align-items: center; gap: 0.5rem; flex-wrap: wrap; font-size: 0.875rem;">
                        <span style="background: var(--accent); color: #000; padding: 0.5rem 1rem; border-radius: 2rem; font-weight: 600;">Calm Number</span>
                        <span style="color: var(--text-muted);">‚Üí</span>
                        <span style="background: var(--card-bg); border: 1px solid var(--card-border); padding: 0.5rem 1rem; border-radius: 2rem;">One Lane</span>
                        <span style="color: var(--text-muted);">‚Üí</span>
                        <span style="background: var(--card-bg); border: 1px solid var(--card-border); padding: 0.5rem 1rem; border-radius: 2rem;">Weekly Score</span>
                        <span style="color: var(--text-muted);">‚Üí</span>
                        <span style="background: var(--card-bg); border: 1px solid var(--card-border); padding: 0.5rem 1rem; border-radius: 2rem;">90-Day Review</span>
                        <span style="color: var(--text-muted);">‚Üí</span>
                        <span style="color: var(--accent);">‚Üª Repeat</span>
                    </div>
                    <p style="color: var(--text-muted); font-size: 0.75rem; margin-top: 1rem;">This is the entire system. Everything else is support.</p>
                </div>

                <!-- SUCCESS DEFINITION + ANTI-FRAGILE -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div class="card" style="margin: 0;">
                        <h4 style="margin-bottom: 0.75rem; font-size: 0.875rem;">Success Defined As:</h4>
                        <ul style="font-size: 0.8rem; color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 0.375rem;">
                            <li>‚Ä¢ Weekly actions executed</li>
                            <li>‚Ä¢ Lane unchanged</li>
                            <li>‚Ä¢ Scorecard completed</li>
                        </ul>
                    </div>
                    <div class="card" style="margin: 0;">
                        <h4 style="color: var(--text-secondary); margin-bottom: 0.75rem; font-size: 0.875rem;">Not Failure:</h4>
                        <ul style="font-size: 0.8rem; color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 0.375rem;">
                            <li>‚Ä¢ Revenue uneven</li>
                            <li>‚Ä¢ Energy inconsistent</li>
                            <li>‚Ä¢ Results lag temporarily</li>
                        </ul>
                    </div>
                </div>

                <!-- ANTI-FRAGILE ASSURANCE -->
                <div style="text-align: center; padding: 1rem; background: rgba(99, 102, 241, 0.1); border-radius: 0.75rem; margin-bottom: 1.5rem;">
                    <div style="font-size: 1rem; font-weight: 600; color: var(--accent);">You cannot fall behind.</div>
                    <div style="font-size: 0.8rem; color: var(--text-secondary);">There is only the current week. Miss one? Start fresh Monday. The system resets. You don't.</div>
                </div>

                <!-- Primary Action -->
                <div class="nav-grid" style="grid-template-columns: 1fr; max-width: 300px; margin: 0 auto 1rem;">
                    <div class="nav-card" onclick="switchTab('weekly')" style="border-color: var(--accent);">
                        <div class="nav-card-icon">üìä</div>
                        <div class="nav-card-title">Weekly Close</div>
                        <div class="nav-card-status">Your primary action</div>
                    </div>
                </div>
                
                <p style="font-size: 0.7rem; color: var(--text-muted); text-align: center; margin-bottom: 1rem; font-style: italic;">If nothing needs updating, close the app.</p>
                
                <!-- More Tools (collapsed by default for new users) -->
                <details id="moreToolsSection" style="margin-bottom: 1rem;">
                    <summary style="cursor: pointer; color: var(--text-muted); font-size: 0.85rem; text-align: center; padding: 0.5rem;">More Tools ‚ñæ</summary>
                    <div class="nav-grid" style="margin-top: 1rem;">
                    <div class="nav-card" onclick="switchTab('pipeline')">
                        <div class="nav-card-icon">üéØ</div>
                        <div class="nav-card-title">Pipeline</div>
                        <div class="nav-card-status" id="pipelineStatus">0 active</div>
                    </div>
                    <div class="nav-card" onclick="switchTab('gci')">
                        <div class="nav-card-icon">üí∞</div>
                        <div class="nav-card-title">GCI</div>
                        <div class="nav-card-status" id="gciStatus">Track income</div>
                    </div>
                    <div class="nav-card" onclick="switchTab('visibility')">
                        <div class="nav-card-icon">üëÅÔ∏è</div>
                        <div class="nav-card-title">Visibility</div>
                        <div class="nav-card-status" id="visibilityStatus">Plan actions</div>
                    </div>
                    <div class="nav-card" onclick="switchTab('review')">
                        <div class="nav-card-icon">üîÑ</div>
                        <div class="nav-card-title">Quarterly Review</div>
                        <div class="nav-card-status">Quarterly refresh</div>
                    </div>
                    <div class="nav-card" onclick="switchTab('build')">
                        <div class="nav-card-icon">üèóÔ∏è</div>
                        <div class="nav-card-title">Build</div>
                        <div class="nav-card-status" id="buildStatus">Plan builder</div>
                    </div>
                    </div>
                </details>

                <!-- STALL PROTOCOL -->
                <div class="card" style="margin-top: 2rem; border: 1px solid var(--warning); background: rgba(245, 158, 11, 0.05);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <span style="font-size: 1.5rem;">üö®</span>
                        <h4 style="color: var(--warning);">When I Stop Trusting the System</h4>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">Read this when nothing feels like it's working. This is your emergency protocol.</p>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="background: var(--warning); color: #000; padding: 0.125rem 0.5rem; border-radius: 4px; font-weight: 700; font-size: 0.75rem;">1</span>
                            <span><strong>Do NOT add new strategies.</strong> The problem isn't the system ‚Äî it's consistency.</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="background: var(--warning); color: #000; padding: 0.125rem 0.5rem; border-radius: 4px; font-weight: 700; font-size: 0.75rem;">2</span>
                            <span><strong>Re-read your Calm Number.</strong> Did you actually hit it? Every week? Be honest.</span>
                        </div>
                        <div id="laneWhyReminder" style="display: none; background: rgba(99, 102, 241, 0.1); border-radius: 0.5rem; padding: 0.75rem 1rem; margin-left: 1.5rem;">
                            <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.25rem;">You chose <strong id="stallLane" style="color: var(--accent);"></strong> because:</div>
                            <div id="stallLaneWhy" style="font-size: 0.875rem; color: var(--text-secondary); font-style: italic;"></div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="background: var(--warning); color: #000; padding: 0.125rem 0.5rem; border-radius: 4px; font-weight: 700; font-size: 0.75rem;">3</span>
                            <span><strong>Execute No-Think Mode for 7 days.</strong> Calm Number only. No creative projects. No new ideas. Just conversations.</span>
                        </div>
                    </div>
                    <div class="ceo-line" style="margin-top: 1rem; font-size: 0.875rem;">
                        "If you're not getting results, you're not doing the work. That's always the answer."
                    </div>
                </div>

                <!-- WHEN LIFE BLOWS UP -->
                <div class="card" style="margin-top: 1rem; border: 1px solid var(--text-muted); background: rgba(107, 114, 128, 0.05);">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                        <span style="font-size: 1.5rem;">üå™Ô∏è</span>
                        <h4 style="color: var(--text-secondary);">When Life Takes Over</h4>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">Illness. Family emergency. Burnout. Mental overload. This system has grace built in.</p>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="background: var(--text-muted); color: #fff; padding: 0.125rem 0.5rem; border-radius: 4px; font-weight: 700; font-size: 0.75rem;">1</span>
                            <span><strong>Shrink your Calm Number.</strong> Cut it in half. Or more. Survival mode is still progress.</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="background: var(--text-muted); color: #fff; padding: 0.125rem 0.5rem; border-radius: 4px; font-weight: 700; font-size: 0.75rem;">2</span>
                            <span><strong>Keep only ONE action.</strong> Database touches. That's it. Everything else can wait.</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="background: var(--text-muted); color: #fff; padding: 0.125rem 0.5rem; border-radius: 4px; font-weight: 700; font-size: 0.75rem;">3</span>
                            <span><strong>Protect the week, not the output.</strong> 1 conversation beats 0. Always.</span>
                        </div>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.8rem; color: var(--text-muted); font-style: italic;">Life interruptions do not break the system. They pause execution. Resume when ready.</p>
                </div>

                <!-- WHY THIS IS DIFFERENT -->
                <div class="card" style="margin-top: 1rem;">
                    <h4 style="color: var(--text-secondary); margin-bottom: 0.75rem; font-size: 0.875rem;">Why This Is Different</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.8rem;">
                        <div>
                            <div style="color: var(--text-muted); margin-bottom: 0.5rem;">Most planners focus on:</div>
                            <ul style="color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 0.25rem;">
                                <li>‚Ä¢ Goals and dreams</li>
                                <li>‚Ä¢ Daily inspiration</li>
                                <li>‚Ä¢ Maximum productivity</li>
                                <li>‚Ä¢ Adding more tactics</li>
                            </ul>
                        </div>
                        <div>
                            <div style="color: var(--accent); margin-bottom: 0.5rem;">This OS focuses on:</div>
                            <ul style="color: var(--text-secondary); list-style: none; display: flex; flex-direction: column; gap: 0.25rem;">
                                <li>‚Ä¢ Removing daily decisions</li>
                                <li>‚Ä¢ Works regardless of how you feel</li>
                                <li>‚Ä¢ Only actions that move deals</li>
                                <li>‚Ä¢ Stop adding. Start finishing.</li>
                            </ul>
                        </div>
                    </div>
                    <p style="margin-top: 1rem; font-size: 0.8rem; color: var(--text-muted); font-style: italic;">This system governs execution. Strategy decisions live outside of it.</p>
                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">This system is not optimized. It is repeatable.</p>
                </div>
                <div class="card" style="margin-top: 1rem; border: 2px solid var(--accent); background: rgba(99, 102, 241, 0.05);">
                    <h4 style="color: var(--accent); margin-bottom: 1rem;">The Laws of THE LANE</h4>
                    <div style="display: flex; flex-direction: column; gap: 1rem; font-size: 0.875rem;">
                        <div>
                            <div style="font-weight: 700; color: var(--text-primary);">Law 1: You don't add a new strategy until this one is boring.</div>
                            <div style="color: var(--text-muted); font-size: 0.8rem;">Every agent who fails breaks this rule first.</div>
                        </div>
                        <div>
                            <div style="font-weight: 700; color: var(--text-primary);">Law 2: You don't change lanes mid-quarter.</div>
                            <div style="color: var(--text-muted); font-size: 0.8rem;">Confusion is not a strategy problem. It's a focus problem.</div>
                        </div>
                        <div>
                            <div style="font-weight: 700; color: var(--text-primary);">Law 3: You don't evaluate results until the system has been executed.</div>
                            <div style="color: var(--text-muted); font-size: 0.8rem;">Four weeks minimum. No judging before then.</div>
                        </div>
                    </div>
                    <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin-top: 1rem; font-style: italic;">Repetition creates leverage.</p>
                </div>

                <!-- IDENTITY CLAIM -->
                <div style="margin-top: 2rem; text-align: center; padding: 1.5rem; background: var(--card-bg); border-radius: 0.75rem;">
                    <p style="color: var(--text-primary); font-size: 1rem; font-weight: 500; margin-bottom: 0.5rem;">
                        Agents who use this OS don't just get organized.
                    </p>
                    <p style="color: var(--accent); font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">
                        They become predictable executors.
                    </p>
                    <p style="color: var(--text-muted); font-size: 0.85rem;">
                        Discipline stops being effort. It becomes identity.
                    </p>
                    <p style="color: var(--text-muted); font-size: 0.75rem; margin-top: 0.5rem; font-style: italic;">
                        If this feels quieter than before, that's progress‚Äînot loss.
                    </p>
                </div>

                <!-- AUTHORITY SIGNAL -->
                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--card-border); text-align: center;">
                    <p style="color: var(--text-muted); font-size: 0.75rem; max-width: 500px; margin: 0 auto; line-height: 1.6;">
                        This system was built in production ‚Äî by a top-producing agent who got tired of strategies that don't survive a bad month. 
                        It's not theory. It's what actually works when the pipeline is empty and decisions feel hard.
                    </p>
                </div>

                <!-- IMMUTABLE CLAUSE -->
                <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(107, 114, 128, 0.05); border-radius: 0.5rem; text-align: center;">
                    <p style="color: var(--text-muted); font-size: 0.7rem; font-weight: 600; margin-bottom: 0.5rem;">THIS SYSTEM WILL NEVER INCLUDE:</p>
                    <p style="color: var(--text-muted); font-size: 0.65rem; line-height: 1.8;">
                        social comparison ¬∑ streak gamification ¬∑ motivational nudges ¬∑ public metrics ¬∑ urgency mechanics
                    </p>
                </div>
            </div>
        </div>

        <!-- ==================== WEEKLY SCORECARD ==================== -->
        <div id="tab-weekly" class="tab-content hidden">
            <div class="container">
                <div class="scorecard-hero">
                    <h2>Weekly Close</h2>
                    <p style="color: var(--text-secondary);">Did you do the work this week?</p>
                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">Right now, the only thing that matters is this week's execution.</p>
                    <div class="week-selector">
                        <button onclick="changeWeek(-1)">‚Üê</button>
                        <span class="week-label" id="currentWeekLabel">Week of Dec 16</span>
                        <button onclick="changeWeek(1)">‚Üí</button>
                    </div>
                </div>

                <div class="scorecard-grid">
                    <div class="scorecard-card">
                        <h4>üìû Execution Metrics</h4>
                        <div class="metric-row">
                            <span class="metric-label">Conversations</span>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="number" class="metric-input" id="week_conversations" onchange="saveWeeklyField('conversations')" placeholder="0">
                                <span style="color: var(--text-muted);">/ <span id="weekConvTarget">8</span></span>
                            </div>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Appointments Set</span>
                            <input type="number" class="metric-input" id="week_appointments" onchange="saveWeeklyField('appointments')" placeholder="0">
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Sphere Touches</span>
                            <input type="number" class="metric-input" id="week_sphere" onchange="saveWeeklyField('sphere')" placeholder="0">
                        </div>
                    </div>

                    <div class="scorecard-card">
                        <h4>‚úÖ Execution Checklist</h4>
                        <div class="check-row" onclick="toggleWeeklyCheck('ceoHour', event)">
                            <input type="checkbox" id="week_ceoHour">
                            <label>Completed CEO Hour</label>
                        </div>
                        <div class="check-row" onclick="toggleWeeklyCheck('visibility', event)">
                            <input type="checkbox" id="week_visibility">
                            <label>Daily visibility action</label>
                        </div>
                        <div class="check-row" onclick="toggleWeeklyCheck('followups', event)">
                            <input type="checkbox" id="week_followups">
                            <label>Follow-ups complete</label>
                        </div>
                        <div class="check-row" onclick="toggleWeeklyCheck('hitTarget', event)">
                            <input type="checkbox" id="week_hitTarget">
                            <label>Hit Calm Number target</label>
                        </div>
                    </div>

                    <div class="scorecard-card">
                        <h4>Database Health</h4>
                        <div class="metric-row">
                            <span class="metric-label">Database Size (approx)</span>
                            <input type="number" class="metric-input" id="week_dbSize" onchange="saveWeeklyField('dbSize'); updateDbHealthMeter()" placeholder="0">
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Touched This Week</span>
                            <input type="number" class="metric-input" id="week_dbTouched" onchange="saveWeeklyField('dbTouched'); updateDbHealthMeter()" placeholder="0">
                        </div>
                        <div class="db-health-section">
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Health Meter (target: 10%+ touched/week)</div>
                            <div class="db-meter">
                                <div class="db-meter-bar">
                                    <div class="db-meter-fill" id="dbMeterFill" style="width: 0%;"></div>
                                </div>
                                <span class="db-meter-label" id="dbMeterPercent">0%</span>
                            </div>
                        </div>
                        <div class="check-row" style="margin-top: 1rem;" onclick="toggleWeeklyCheck('referralAsk', event)">
                            <input type="checkbox" id="week_referralAsk">
                            <label>Made a referral ask</label>
                        </div>
                    </div>

                    <div class="scorecard-card">
                        <h4>Weeks Completed</h4>
                        <div style="text-align: center; padding: 1rem 0;">
                            <div style="font-size: 2.5rem; font-weight: 700; color: var(--text-primary);" id="weeksCompleted">0</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">Total weeks closed</div>
                        </div>
                        <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; font-style: italic;">
                            Weeks are the unit of leverage.
                        </p>
                    </div>

                    <div class="scorecard-card" style="grid-column: span 2;">
                        <h4>Quick Reflection</h4>
                        <div class="form-group" style="margin-bottom: 1rem;">
                            <label>Result of the week</label>
                            <input type="text" id="week_win" onchange="saveWeeklyField('win')" placeholder="What worked?">
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Lesson learned</label>
                            <input type="text" id="week_lesson" onchange="saveWeeklyField('lesson')" placeholder="What will you do differently?">
                        </div>
                    </div>
                </div>

                <div style="text-align: center;">
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 1rem; font-style: italic;">Some weeks are maintenance weeks. The system still counts.</p>
                    <button class="btn btn-primary" onclick="completeWeek()">Close Week</button>
                </div>
            </div>
        </div>

        <!-- ==================== PIPELINE ==================== -->
        <div id="tab-pipeline" class="tab-content hidden">
            <div class="container">
                <div class="pipeline-header">
                    <div>
                        <h2>Deal Pipeline</h2>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.25rem;">Review weekly. Update only when something changes.</p>
                    </div>
                    <div class="pipeline-stats">
                        <div class="pipeline-stat">
                            <div class="pipeline-stat-value" id="pipelineActiveCount">0</div>
                            <div class="pipeline-stat-label">Active Deals</div>
                        </div>
                        <div class="pipeline-stat">
                            <div class="pipeline-stat-value" style="color: var(--accent);" id="pipelineProjectedGCI">$0</div>
                            <div class="pipeline-stat-label">Projected GCI</div>
                        </div>
                        <div class="pipeline-stat">
                            <div class="pipeline-stat-value" id="pipelineClosedYTD">0</div>
                            <div class="pipeline-stat-label">Closed YTD</div>
                        </div>
                        <div class="pipeline-stat">
                            <div class="pipeline-stat-value" style="color: var(--success);" id="pipelineGCIYTD">$0</div>
                            <div class="pipeline-stat-label">GCI YTD</div>
                        </div>
                    </div>
                </div>

                <div class="ceo-line" style="margin-bottom: 1.5rem;">
                    "Silence does not mean failure. Lag is normal. Keep working the process."
                </div>

                <div class="pipeline-stages" id="pipelineStages">
                    <!-- Rendered by JS -->
                </div>
            </div>
        </div>

        <!-- ==================== GCI TRACKER ==================== -->
        <div id="tab-gci" class="tab-content hidden">
            <div class="container">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <h2>GCI Tracker</h2>
                    <p style="color: var(--text-secondary);">Track your income. Know your number.</p>
                </div>

                <div class="gci-summary">
                    <div class="gci-summary-card">
                        <div class="gci-summary-value" style="color: var(--accent);" id="gciGoal">$0</div>
                        <div class="gci-summary-label">2026 Goal</div>
                    </div>
                    <div class="gci-summary-card">
                        <div class="gci-summary-value" style="color: var(--success);" id="gciActualYTD">$0</div>
                        <div class="gci-summary-label">Actual YTD</div>
                    </div>
                    <div class="gci-summary-card">
                        <div class="gci-summary-value" id="gciRemaining">$0</div>
                        <div class="gci-summary-label">Remaining</div>
                    </div>
                    <div class="gci-summary-card">
                        <div class="gci-summary-value" id="gciPacePercent">0%</div>
                        <div class="gci-summary-label">Of Goal</div>
                    </div>
                </div>

                <div class="progress-bar" style="height: 12px; margin-bottom: 2rem;">
                    <div class="progress-fill" id="gciProgressBar" style="width: 0%;"></div>
                </div>

                <div class="gci-months" id="gciMonths">
                    <!-- Rendered by JS -->
                </div>
            </div>
        </div>

        <!-- ==================== VISIBILITY PLANNER ==================== -->
        <div id="tab-visibility" class="tab-content hidden">
            <div class="container">
                <div class="visibility-header">
                    <div>
                        <h2>Visibility Planner</h2>
                        <p style="color: var(--text-secondary);">1 action per day. Every day.</p>
                    </div>
                    <div class="visibility-stats">
                        <div class="visibility-stat">
                            <div class="visibility-stat-value" style="color: var(--success);" id="visibilityDone">0</div>
                            <div class="visibility-stat-label">Days Done</div>
                        </div>
                        <div class="visibility-stat">
                            <div class="visibility-stat-value" id="visibilityTotal">0</div>
                            <div class="visibility-stat-label">Days in Month</div>
                        </div>
                        <div class="visibility-stat">
                            <div class="visibility-stat-value" style="color: var(--accent);" id="visibilityRate">0%</div>
                            <div class="visibility-stat-label">Completion</div>
                        </div>
                    </div>
                </div>

                <div class="visibility-month-selector" style="justify-content: center; margin-bottom: 1.5rem;">
                    <button onclick="changeVisibilityMonth(-1)">‚Üê</button>
                    <span class="visibility-month-label" id="visibilityMonthLabel">December 2025</span>
                    <button onclick="changeVisibilityMonth(1)">‚Üí</button>
                </div>

                <div class="ceo-line" style="margin-bottom: 1.5rem;">
                    "Be seen every day. Social post. Video. Open house. Pop-by. Something."
                </div>

                <div class="visibility-calendar" id="visibilityCalendar">
                    <!-- Rendered by JS -->
                </div>
            </div>
        </div>

        <!-- ==================== MONTHLY ACTIVITY CALENDAR ==================== -->
        <div id="tab-activity" class="tab-content hidden">
            <div class="container">
                <div class="visibility-header">
                    <div>
                        <h2>Execution Calendar</h2>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.25rem;">The system measures activity. Meaning is optional.</p>
                    </div>
                    <div class="visibility-stats">
                        <div class="visibility-stat">
                            <div class="visibility-stat-value" style="color: var(--success);" id="activityDaysHit">0</div>
                            <div class="visibility-stat-label">Days Hit Target</div>
                        </div>
                        <div class="visibility-stat">
                            <div class="visibility-stat-value" id="activityTotalConvos">0</div>
                            <div class="visibility-stat-label">Total Convos</div>
                        </div>
                        <div class="visibility-stat">
                            <div class="visibility-stat-value" style="color: var(--accent);" id="activityAvgDaily">0</div>
                            <div class="visibility-stat-label">Daily Avg</div>
                        </div>
                    </div>
                </div>

                <div class="visibility-month-selector" style="justify-content: center; margin-bottom: 1.5rem;">
                    <button onclick="changeActivityMonth(-1)">‚Üê</button>
                    <span class="visibility-month-label" id="activityMonthLabel">December 2025</span>
                    <button onclick="changeActivityMonth(1)">‚Üí</button>
                </div>

                <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin-bottom: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                        <div style="width: 16px; height: 16px; background: var(--success); border-radius: 4px;"></div>
                        <span>Hit Target</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                        <div style="width: 16px; height: 16px; background: var(--warning); border-radius: 4px;"></div>
                        <span>Close (1 short)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                        <div style="width: 16px; height: 16px; background: var(--danger); border-radius: 4px;"></div>
                        <span>Not Executed</span>
                    </div>
                </div>

                <div class="ceo-line" style="margin-bottom: 1.5rem;">
                    "The Calm Number is a daily promise. Keep it and your income becomes predictable."
                </div>
                <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin-bottom: 1.5rem; font-style: italic;">Consistency removes anxiety.</p>

                <div class="visibility-calendar" id="activityCalendar">
                    <!-- Rendered by JS -->
                </div>
            </div>
        </div>

        <!-- ==================== 90-DAY RESET ==================== -->
        <div id="tab-review" class="tab-content hidden">
            <div class="container">
                <div style="text-align: center; margin-bottom: 1rem;">
                    <h2>90-Day Review</h2>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">Do not review until the quarter is closed.</p>
                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">Consistency reveals viability. If execution was real and results were not, redesign is allowed.</p>
                </div>

                <div class="sprint-selector" id="sprintSelector">
                    <!-- Rendered by JS -->
                </div>

                <div id="sprintContent">
                    <!-- Rendered by JS -->
                </div>
            </div>
        </div>

        <!-- ==================== PLAN BUILDER ==================== -->
        <div id="tab-build" class="tab-content hidden">
            <div class="container">
                <div class="builder-progress">
                    <div class="builder-progress-fill">
                        <div class="builder-progress-fill-inner" id="builderProgressFill" style="width: 7%;"></div>
                    </div>
                    <span class="builder-progress-text" id="builderProgressText">Step 1 of 14</span>
                </div>

                <!-- Step 1: Reflection -->
                <div class="builder-step active" data-step="1">
                    <h2>Before We Begin</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">Ground yourself. Why are you doing this?</p>
                    <div class="form-group">
                        <label>What does achieving your income goal actually mean for your life?</label>
                        <textarea id="opening_reflection" placeholder="Be specific. This is your anchor when it gets hard."></textarea>
                    </div>
                </div>

                <!-- Step 2: Identity -->
                <div class="builder-step" data-step="2">
                    <h2>Your Identity</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">The basics that define you.</p>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Your Name</label>
                            <input type="text" id="name" placeholder="As you want to be known">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="email" placeholder="your@email.com">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Market Area</label>
                        <input type="text" id="market_area" placeholder="e.g., Northern Colorado, Denver Metro">
                    </div>
                </div>

                <!-- Step 3: Who You Serve -->
                <div class="builder-step" data-step="3">
                    <h2>Who You Serve</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">Clarity on your ideal client makes everything easier.</p>
                    <div class="form-group">
                        <label>Who is your ideal client?</label>
                        <textarea id="who_i_serve" placeholder="Be specific: demographics, situation, mindset"></textarea>
                    </div>
                    <div class="form-group">
                        <label>What decision are they trying to make?</label>
                        <textarea id="what_decision" placeholder="What's the real problem you solve?"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Who is NOT a good fit for you?</label>
                        <textarea id="who_not_for" placeholder="Be honest about who you don't serve well"></textarea>
                    </div>
                </div>

                <!-- Step 4: Voice & Brand -->
                <div class="builder-step" data-step="4">
                    <h2>Your Voice</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">How you sound defines how you're remembered.</p>
                    <div class="form-group">
                        <label>My voice feels like...</label>
                        <input type="text" id="voice_feels_like" placeholder="e.g., Straight-shooter with a heart">
                    </div>
                    <div class="form-group">
                        <label>I want clients to feel...</label>
                        <input type="text" id="clients_feel" placeholder="e.g., Confident, informed, not pressured">
                    </div>
                    <div class="form-group">
                        <label>Go-to phrases I use</label>
                        <textarea id="go_to_phrases" placeholder="The things you say that feel like YOU"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Words I never use</label>
                        <input type="text" id="words_avoid" placeholder="e.g., Hustle, crushing it, deal of a lifetime">
                    </div>
                </div>

                <!-- Step 5: Positioning -->
                <div class="builder-step" data-step="5">
                    <h2>Your Positioning</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">What makes you different (and memorable)?</p>
                    <div class="form-group">
                        <label>What makes you different from other agents?</label>
                        <textarea id="differentiator" placeholder="Not 'I care more' ‚Äî what's actually different?"></textarea>
                    </div>
                    <div class="form-group">
                        <label>What do you believe that others don't?</label>
                        <textarea id="what_i_believe" placeholder="Your contrarian truth"></textarea>
                    </div>
                    <div class="form-group">
                        <label>What do you refuse to do?</label>
                        <textarea id="what_i_refuse" placeholder="Lines you won't cross"></textarea>
                    </div>
                </div>

                <!-- Step 6: Content Style -->
                <div class="builder-step" data-step="6">
                    <h2>Content Style</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">How you show up online and in conversations.</p>
                    <div class="form-group">
                        <label>Your CTA style</label>
                        <input type="text" id="cta_style" placeholder="e.g., 'Text me' vs 'Schedule a consultation'">
                    </div>
                    <div class="form-group">
                        <label>What do you want to be known for?</label>
                        <textarea id="known_for" placeholder="The one thing people say about you"></textarea>
                    </div>
                </div>

                <!-- Step 7: Business Focus -->
                <div class="builder-step" data-step="7">
                    <h2>Business Focus</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">Where you'll concentrate your energy.</p>
                    <div class="form-group">
                        <label>Primary business focus</label>
                        <input type="text" id="business_focus" placeholder="e.g., First-time buyers, luxury listings, relocations">
                    </div>
                    <div class="form-group">
                        <label>Primary lead source</label>
                        <input type="text" id="lead_source" placeholder="e.g., Sphere, social media, open houses">
                    </div>
                </div>

                <!-- Step 8: Client Psychology -->
                <div class="builder-step" data-step="8">
                    <h2>Client Psychology</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">Understanding their fears helps you serve them better.</p>
                    <div class="form-group">
                        <label>What's your clients' biggest fear?</label>
                        <textarea id="client_fear" placeholder="The thing that keeps them up at night"></textarea>
                    </div>
                    <div class="form-group">
                        <label>What do you find yourself explaining over and over?</label>
                        <textarea id="repeat_explanation" placeholder="Document the full answer here"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Why do you actually care about helping them?</label>
                        <textarea id="why_i_care" placeholder="Your real motivation, not the script"></textarea>
                    </div>
                </div>

                <!-- Step 9: Decision Framework -->
                <div class="builder-step" data-step="9">
                    <h2>How You Make Decisions</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">Your decision style determines your business shape.</p>
                    <div class="form-group">
                        <label>Default decision style</label>
                        <select id="decision_style">
                            <option value="">Select...</option>
                            <option value="data">Data-driven (show me the numbers)</option>
                            <option value="gut">Gut-driven (I trust my instincts)</option>
                            <option value="collaborative">Collaborative (I ask my people)</option>
                            <option value="research">Research-first (I need all the info)</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-top: 1.5rem;">
                        <label>What matters most in your business? (Check your top 3)</label>
                        <div class="decision-grid" style="margin-top: 0.5rem;">
                            <label class="decision-option"><input type="checkbox" id="decision_trust"><span>Building deep trust</span></label>
                            <label class="decision-option"><input type="checkbox" id="decision_accuracy"><span>Being technically accurate</span></label>
                            <label class="decision-option"><input type="checkbox" id="decision_education"><span>Educating clients</span></label>
                            <label class="decision-option"><input type="checkbox" id="decision_relationships"><span>Long-term relationships</span></label>
                            <label class="decision-option"><input type="checkbox" id="decision_simplicity"><span>Making it simple</span></label>
                            <label class="decision-option"><input type="checkbox" id="decision_consistency"><span>Consistent communication</span></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Anything else that's important to how you operate?</label>
                        <textarea id="custom_decision" placeholder="Your unique operating principles"></textarea>
                    </div>
                </div>

                <!-- Step 10: The Math -->
                <div class="builder-step" data-step="10">
                    <h2>The Math</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">This is your Calm Number calculation.</p>
                    <div class="ceo-line" style="margin-bottom: 1.5rem;">
                        "The Calm Number removes emotion from business. It's just math."
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Income Goal</label>
                            <input type="text" id="income_goal" placeholder="e.g., $150,000">
                        </div>
                        <div class="form-group">
                            <label>Average Commission</label>
                            <input type="text" id="avg_commission" placeholder="e.g., $8,000">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Appointments per Deal (ratio)</label>
                            <input type="number" id="appt_ratio" placeholder="e.g., 4" value="4">
                        </div>
                        <div class="form-group">
                            <label>Deals Needed (calculated)</label>
                            <input type="number" id="deals_needed" readonly style="background: var(--accent-dim);">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Appointments Needed (calculated)</label>
                            <input type="number" id="appointments_needed" readonly style="background: var(--accent-dim);">
                        </div>
                        <div class="form-group">
                            <label>Weekly Conversations = Your Calm Number</label>
                            <input type="number" id="weekly_conversations" readonly style="background: var(--accent); color: #000; font-weight: 700;">
                        </div>
                    </div>
                </div>

                <!-- Step 11: CEO Hour -->
                <div class="builder-step" data-step="11">
                    <h2>Your CEO Hour</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">One protected hour. No negotiation.</p>
                    <div class="ceo-line" style="margin-bottom: 1.5rem;">
                        "The CEO Hour is sacred. It's when you work ON your business, not IN it."
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Day</label>
                            <select id="ceo_hour_day">
                                <option value="">Select day...</option>
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                                <option value="Saturday">Saturday</option>
                                <option value="Sunday">Sunday</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Time</label>
                            <input type="time" id="ceo_hour_time">
                        </div>
                    </div>
                </div>

                <!-- Step 12: Visibility -->
                <div class="builder-step" data-step="12">
                    <h2>Daily Visibility</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">How will you be seen every single day?</p>
                    <div class="form-group">
                        <label>Your visibility commitment</label>
                        <textarea id="visibility_commitment" placeholder="e.g., One social post daily, 2 pop-bys per week, weekly video"></textarea>
                        <p class="form-hint">Be realistic. Consistency beats intensity.</p>
                    </div>
                </div>

                <!-- Step 13: 30-Day Focus -->
                <div class="builder-step" data-step="13">
                    <h2>30-Day Focus</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">What's the ONE thing for the next 30 days?</p>
                    <div class="form-group">
                        <label>Your 30-day focus</label>
                        <input type="text" id="thirty_day_focus" placeholder="Just one thing. Not three.">
                    </div>
                    <div class="form-group">
                        <label>What will you ignore?</label>
                        <textarea id="ignore_distractions" placeholder="What shiny objects will you actively avoid?"></textarea>
                    </div>
                </div>

                <!-- Step 14: Commit -->
                <div class="builder-step" data-step="14">
                    <h2>Your Commitment</h2>
                    <p style="color: var(--text-secondary); margin: 1rem 0 2rem;">This is where words become action.</p>
                    <div class="card" style="text-align: center; padding: 2rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö°</div>
                        <h3 style="margin-bottom: 1rem;">Your Operating System is Ready</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                            Your Calm Number: <strong id="finalCalmNumber">‚Äî</strong> conversations/week<br>
                            Your CEO Hour: <strong id="finalCeoHour">‚Äî</strong><br>
                            Your Lane: <strong id="finalLane">‚Äî</strong>
                        </p>
                        <div class="ceo-line" style="text-align: left; margin-bottom: 1.5rem;">
                            "The plan means nothing. The execution means everything. Go hit your number."
                        </div>
                        <button class="btn btn-primary" onclick="completePlanBuilder()">Activate Operating System ‚Üí</button>
                    </div>
                </div>

                <div class="builder-nav" id="builderNav">
                    <button class="btn btn-secondary" onclick="prevBuilderStep()" id="builderPrevBtn" style="visibility: hidden;">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextBuilderStep()" id="builderNextBtn">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- ==================== TRACK (PULSE CHECK) ==================== -->
        <div id="tab-track" class="tab-content hidden">
            <div class="container">
                <h2>Monthly Pulse Check</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">How are you really doing?</p>
                
                <div class="month-tabs" id="pulseMonthTabs"></div>
                <div id="pulseContent"></div>
            </div>
        </div>

        <!-- ==================== AUDIT (STANDARDS) ==================== -->
        <div id="tab-audit" class="tab-content hidden">
            <div class="container">
                <h2>14 Standards Audit</h2>
                <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">Are you operating at your standard?</p>
                <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 1.5rem; font-style: italic;">This is for clarity, not judgment.</p>
                <div id="standardsContent"></div>
            </div>
        </div>

        <!-- ==================== PROMPTS ==================== -->
        <div id="tab-prompts" class="tab-content hidden">
            <div class="container">
                <h2>AI Prompt Library</h2>
                <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">Use these with ChatGPT, Claude, or any AI assistant. Your Brand DNA makes them specific to you.</p>
                <p style="color: var(--accent); font-size: 0.875rem; margin-bottom: 2rem;">üí° This alone differentiates you from 90% of agents still guessing at content.</p>
                <div id="promptsContent"></div>
            </div>
        </div>
    </div>

    <!-- ==================== MODALS ==================== -->
    <div id="dealModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 id="dealModalTitle">Add Deal</h3>
                <button class="modal-close" onclick="closeDealModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Client Name</label>
                    <input type="text" id="deal_name" placeholder="Client name">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Stage</label>
                        <select id="deal_stage">
                            <option value="lead">Lead</option>
                            <option value="nurturing">Nurturing</option>
                            <option value="active">Active Search</option>
                            <option value="contract">Under Contract</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="deal_type">
                            <option value="buyer">Buyer</option>
                            <option value="seller">Seller</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Expected GCI</label>
                        <input type="text" id="deal_gci" placeholder="e.g., $8,000">
                    </div>
                    <div class="form-group">
                        <label>Expected Close Date</label>
                        <input type="date" id="deal_closeDate">
                    </div>
                </div>
                <div class="form-group">
                    <label>Lead Source</label>
                    <input type="text" id="deal_source" placeholder="e.g., Sphere, Open House, Social">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="dealDeleteBtn" onclick="deleteDeal()" style="margin-right: auto; display: none;">Delete</button>
                <button class="btn btn-secondary" onclick="closeDealModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveDeal()">Save Deal</button>
            </div>
        </div>
    </div>

    <div id="visibilityModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 id="visibilityModalTitle">Visibility Action</h3>
                <button class="modal-close" onclick="closeVisibilityModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>What visibility action did you take?</label>
                    <input type="text" id="visibility_action" placeholder="e.g., Posted market update video">
                </div>
                <div class="check-row" onclick="document.getElementById('visibility_completed').checked = !document.getElementById('visibility_completed').checked" style="margin-top: 1rem;">
                    <input type="checkbox" id="visibility_completed">
                    <label>Mark as completed</label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeVisibilityModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveVisibilityAction()">Save</button>
            </div>
        </div>
    </div>

    <div id="activityModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 id="activityModalTitle">Log Conversations</h3>
                <button class="modal-close" onclick="closeActivityModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>How many conversations did you have?</label>
                    <input type="number" id="activity_count" min="0" placeholder="0" style="font-size: 1.5rem; text-align: center;">
                    <p class="form-hint" style="margin-top: 0.5rem;">Daily target: <strong id="activity_target">2</strong> (based on your Calm Number)</p>
                </div>
                <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 0.5rem; padding: 1rem; margin-top: 1rem;">
                    <p style="font-size: 0.875rem; color: var(--text-secondary);">
                        <strong>What counts as a conversation?</strong><br>
                        A real dialogue with a potential client, past client, or sphere member. Not texts. Not DMs. Real conversations.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeActivityModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveActivityCount()">Save</button>
            </div>
        </div>
    </div>

    <div id="shareModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3>Weekly Report</h3>
                <button class="modal-close" onclick="closeShareModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">Share this with your coach or accountability partner:</p>
                <div class="share-preview" id="sharePreview">
                    <!-- Generated by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeShareModal()">Close</button>
                <button class="btn btn-primary" onclick="copyShareReport()">üìã Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        const STORAGE_KEY = 'the_lane_2026';
        
        let state = {
            onboardingComplete: false,
            year: 2026,
            theme: 'dark',
            profile: { name: '', incomeGoal: '', lane: '', laneLockDate: null, experience: '' },
            vision: { differentDays: '', stressGone: '', staySmall: '' },
            commitments: { oneLane: false, repetition: false, finishingWeeks: false, signature: '', date: null },
            plan: {},
            pulse: {},
            standards: {},
            weekly: {},
            currentWeek: getWeekKey(new Date()),
            deals: [],
            closedDeals: [],
            sprints: {},
            currentSprint: 'Q1',
            gci: {}, // Monthly GCI tracking
            visibility: {}, // Daily visibility tracking
            currentVisibilityMonth: new Date().toISOString().slice(0, 7), // YYYY-MM
            activity: {}, // Daily conversation tracking: { 'YYYY-MM-DD': count }
            currentActivityMonth: new Date().toISOString().slice(0, 7) // YYYY-MM
        };

        // BUG FIX: Week starts on MONDAY now
        function getWeekKey(date) {
            const d = new Date(date);
            d.setHours(0, 0, 0, 0);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust to Monday
            d.setDate(diff);
            return d.toISOString().split('T')[0];
        }

        function getWeekLabel(weekKey) {
            const parts = weekKey.split('-');
            const d = new Date(parts[0], parts[1] - 1, parts[2]);
            return 'Week of ' + d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function loadState() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    state = { ...state, ...JSON.parse(saved) };
                } catch (e) { console.error('Error loading state:', e); }
            }
        }

        function saveState() {
            state.lastActivity = new Date().toISOString();
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
            showNotification('Saved');
        }
        
        function dismissWelcomeBack() {
            state.welcomeBackDismissed = new Date().toISOString();
            saveState();
            document.getElementById('welcomeBackBanner').style.display = 'none';
        }
        
        function exportData() {
            const exportObj = {
                ...state,
                exportDate: new Date().toISOString(),
                version: 'THE-LANE-Canonical-v1.0',
                thesis: 'Predictable income is not built by intensity. It is built by repeatable weeks.'
            };
            const dataStr = JSON.stringify(exportObj, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `the-lane-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showNotification(message, duration = 2000) {
            const notification = document.getElementById('systemNotification');
            notification.textContent = message;
            notification.classList.add('visible');
            setTimeout(() => notification.classList.remove('visible'), duration);
        }

        function debounce(func, wait) {
            let timeout;
            return function(...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        // ==================== BACKUP & RESTORE ====================
        function exportBackup() {
            const backup = {
                version: 'v6',
                exportDate: new Date().toISOString(),
                data: state
            };
            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `the-lane-backup-${state.profile.name || 'agent'}-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('Backup downloaded');
        }

        function importBackup(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);
                    
                    // Validate backup structure
                    if (!backup.data || !backup.data.profile) {
                        throw new Error('Invalid backup file format');
                    }
                    
                    // Confirm before overwriting
                    const confirmMsg = backup.data.profile.name 
                        ? `Restore backup for "${backup.data.profile.name}" from ${new Date(backup.exportDate).toLocaleDateString()}?\n\nThis will replace ALL current data.`
                        : `Restore backup from ${new Date(backup.exportDate).toLocaleDateString()}?\n\nThis will replace ALL current data.`;
                    
                    if (confirm(confirmMsg)) {
                        state = backup.data;
                        saveState();
                        alert('Data restored. Reloading.');
                        location.reload();
                    }
                } catch (err) {
                    alert('Error reading backup file. Ensure this is a valid THE LANE backup.');
                    console.error('Import error:', err);
                }
            };
            reader.readAsText(file);
            event.target.value = ''; // Reset file input
        }

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            loadState();
            
            if (state.onboardingComplete) {
                document.getElementById('onboarding').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                initMainApp();
            } else {
                initOnboarding();
            }
            
            if (state.theme === 'light') document.body.classList.add('light-mode');
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => switchTab(btn.dataset.tab));
            });
            
            document.querySelectorAll('.lane-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.lane-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    this.querySelector('input').checked = true;
                    
                    // Show/hide custom lane input for "Other" option
                    const otherInput = document.getElementById('otherLaneInput');
                    if (this.querySelector('input').value === 'Other') {
                        otherInput.style.display = 'block';
                        document.getElementById('customLaneName').focus();
                    } else {
                        otherInput.style.display = 'none';
                    }
                });
            });
        });

        // ==================== ONBOARDING ====================
        let onboardingStep = 1;

        function initOnboarding() { updateOnboardingStep(); }

        function updateOnboardingStep() {
            document.querySelectorAll('.onboarding-step').forEach(step => {
                step.classList.remove('active');
                if (parseInt(step.dataset.step) === onboardingStep) step.classList.add('active');
            });
            
            // Update progress indicator
            const progressEl = document.getElementById('onboardingProgress');
            const fillEl = document.getElementById('onboardingProgressFill');
            const textEl = document.getElementById('onboardingProgressText');
            
            if (onboardingStep === 1) {
                progressEl.style.display = 'none';
            } else {
                progressEl.style.display = 'block';
                const percent = (onboardingStep / 8) * 100;
                fillEl.style.width = percent + '%';
                const minutesRemaining = Math.max(1, Math.ceil((8 - onboardingStep) * 0.5));
                textEl.textContent = `Step ${onboardingStep} of 8 ‚Ä¢ ~${minutesRemaining} minute${minutesRemaining > 1 ? 's' : ''} remaining`;
            }
        }

        function nextOnboardingStep() {
            if (onboardingStep === 3) {
                state.profile.name = document.getElementById('ob_name').value;
                state.profile.incomeGoal = document.getElementById('ob_income_goal').value;
            }
            if (onboardingStep === 4) {
                const selected = document.querySelector('input[name="lane"]:checked');
                if (selected) {
                    if (selected.value === 'Other') {
                        const customLane = document.getElementById('customLaneName').value.trim();
                        state.profile.lane = customLane ? customLane : 'Other';
                    } else {
                        state.profile.lane = selected.value;
                    }
                    state.profile.laneLockDate = new Date().toISOString();
                    state.profile.laneWhy = document.getElementById('ob_lane_why').value.trim();
                }
            }
            if (onboardingStep === 5) {
                const selected = document.querySelector('input[name="experience"]:checked');
                if (selected) state.profile.experience = selected.value;
            }
            if (onboardingStep === 6) {
                state.vision = {
                    differentDays: document.getElementById('ob_vision_days').value,
                    stressGone: document.getElementById('ob_vision_stress').value,
                    staySmall: document.getElementById('ob_vision_small').value
                };
                // Set commitment date
                const today = new Date();
                document.getElementById('commitDate').textContent = today.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                // Pre-fill signature with name if entered
                if (state.profile.name) {
                    document.getElementById('commitSignature').value = state.profile.name;
                }
            }
            if (onboardingStep === 7) {
                // Save commitments
                state.commitments = {
                    oneLane: document.getElementById('commit1').checked,
                    repetition: document.getElementById('commit2').checked,
                    finishingWeeks: document.getElementById('commit3').checked,
                    signature: document.getElementById('commitSignature').value,
                    date: new Date().toISOString()
                };
                // Populate confirmation screen
                document.getElementById('confirmName').textContent = state.profile.name || '‚Äî';
                document.getElementById('confirmGoal').textContent = state.profile.incomeGoal || '‚Äî';
                document.getElementById('confirmLane').textContent = state.profile.lane || '‚Äî';
                document.getElementById('confirmExperience').textContent = state.profile.experience || '‚Äî';
            }
            onboardingStep++;
            updateOnboardingStep();
        }

        function prevOnboardingStep() { onboardingStep--; updateOnboardingStep(); }

        function completeOnboarding() {
            state.onboardingComplete = true;
            saveState();
            
            document.getElementById('onboarding').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            initMainApp();
        }

        // ==================== MAIN APP ====================
        function initMainApp() {
            updateCommandCenter();
            initPlanBuilder();
            initWeeklyScorecard();
            initPipeline();
            initGCITracker();
            initVisibilityPlanner();
            initActivityCalendar();
            initSprintReview();
            initPulseCheck();
            initStandards();
            initPrompts();
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabName) btn.classList.add('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById('tab-' + tabName).classList.remove('hidden');
            
            if (tabName === 'command') updateCommandCenter();
            if (tabName === 'weekly') renderWeeklyScorecard();
            if (tabName === 'pipeline') renderPipeline();
            if (tabName === 'gci') renderGCITracker();
            if (tabName === 'visibility') renderVisibilityPlanner();
            if (tabName === 'activity') renderActivityCalendar();
        }

        function toggleTheme() {
            state.theme = state.theme === 'dark' ? 'light' : 'dark';
            document.body.classList.toggle('light-mode');
            saveState();
        }

        // ==================== CELEBRATIONS ====================
        function getWeekNumber(date) {
            const d = new Date(date);
            const startOfYear = new Date(d.getFullYear(), 0, 1);
            const days = Math.floor((d - startOfYear) / (24 * 60 * 60 * 1000));
            return Math.ceil((days + startOfYear.getDay() + 1) / 7);
        }

        function updateYearProgress() {
            const now = new Date();
            const weekNum = getWeekNumber(now);
            document.getElementById('currentWeekNumber').textContent = weekNum;
        }

        function checkWeekComplete() {
            const thisWeek = state.weekly[state.currentWeek] || {};
            const banner = document.getElementById('weekCompleteBanner');
            
            if (thisWeek.completed) {
                banner.style.display = 'block';
            } else {
                banner.style.display = 'none';
            }
        }

        // ==================== COMMAND CENTER ====================
        function updateCommandCenter() {
            document.getElementById('userName').textContent = state.profile.name || 'Agent';
            
            // Update year progress
            updateYearProgress();
            
            // Check week complete status
            checkWeekComplete();
            
            // Week 1 reassurance banner (only first 7 days)
            const week1Banner = document.getElementById('week1ReassuranceBanner');
            if (state.commitments?.date) {
                const commitDate = new Date(state.commitments.date);
                const daysSinceCommit = Math.floor((new Date() - commitDate) / (1000 * 60 * 60 * 24));
                week1Banner.style.display = daysSinceCommit <= 7 ? 'block' : 'none';
            } else {
                week1Banner.style.display = 'none';
            }
            
            // Welcome back banner (shown once after 14+ day absence)
            const welcomeBackBanner = document.getElementById('welcomeBackBanner');
            if (state.lastActivity && !state.welcomeBackDismissed) {
                const lastActive = new Date(state.lastActivity);
                const daysSinceActive = Math.floor((new Date() - lastActive) / (1000 * 60 * 60 * 24));
                welcomeBackBanner.style.display = daysSinceActive >= 14 ? 'block' : 'none';
            } else {
                welcomeBackBanner.style.display = 'none';
            }
            
            const calmNumber = state.plan.weekly_conversations || '‚Äî';
            document.getElementById('displayCalmNumber').textContent = calmNumber;
            
            // This week's progress
            const thisWeek = state.weekly[state.currentWeek] || {};
            const convs = thisWeek.conversations || 0;
            const target = parseInt(state.plan.weekly_conversations) || 0;
            document.getElementById('displayThisWeek').textContent = target > 0 ? `${convs}/${target}` : '‚Äî';
            
            // Weeks Completed (computed, not stored)
            document.getElementById('displayWeeksCompleted').textContent = computeWeeksCompleted();
            
            // Pipeline
            const activeDeals = state.deals.filter(d => d.stage !== 'closed').length;
            const projectedGCI = state.deals.filter(d => d.stage !== 'closed').reduce((sum, d) => sum + parseFloat(d.gci?.replace(/[^0-9.]/g, '') || 0), 0);
            document.getElementById('displayPipelineCount').textContent = activeDeals;
            document.getElementById('displayPipelineGCI').textContent = '$' + projectedGCI.toLocaleString() + ' projected';
            
            // YTD GCI
            const ytdGCI = calculateYTDGCI();
            const goal = parseFloat(state.profile.incomeGoal?.replace(/[^0-9.]/g, '') || 0);
            document.getElementById('displayYTDGCI').textContent = '$' + ytdGCI.toLocaleString();
            document.getElementById('displayGCIProgress').textContent = goal > 0 ? Math.round(ytdGCI / goal * 100) + '% of goal' : 'of goal';
            
            // Quick reference
            document.getElementById('qrLane').textContent = state.profile.lane || '‚Äî';
            document.getElementById('qrCalmNumber').textContent = calmNumber !== '‚Äî' ? `${calmNumber}/week` : '‚Äî';
            document.getElementById('qrCeoHour').textContent = state.plan.ceo_hour_day && state.plan.ceo_hour_time ? 
                `${state.plan.ceo_hour_day}s ${state.plan.ceo_hour_time}` : '‚Äî';
            document.getElementById('qr30DayFocus').textContent = state.plan.thirty_day_focus || '‚Äî';
            
            // Nav card statuses
            document.getElementById('pipelineStatus').textContent = `${activeDeals} active deal${activeDeals !== 1 ? 's' : ''}`;
            document.getElementById('buildStatus').textContent = state.plan.weekly_conversations ? 'Complete' : 'Not started';
            document.getElementById('gciStatus').textContent = '$' + ytdGCI.toLocaleString() + ' YTD';
            
            // Visibility status
            const visMonth = state.visibility[state.currentVisibilityMonth] || {};
            const visDone = Object.values(visMonth).filter(v => v.completed).length;
            document.getElementById('visibilityStatus').textContent = visDone + ' days this month';
            
            // CEO Summary panel
            document.getElementById('ceoLane').textContent = state.profile.lane || '‚Äî';
            document.getElementById('ceoCalmNumber').textContent = target > 0 ? target : '‚Äî';
            document.getElementById('ceoLogged').textContent = convs;
            
            const ceoStatusEl = document.getElementById('ceoStatus');
            if (thisWeek.completed) {
                ceoStatusEl.textContent = 'Week Closed';
                ceoStatusEl.style.background = 'var(--bg-secondary)';
                ceoStatusEl.style.color = 'var(--text-secondary)';
            } else if (target > 0 && convs >= target) {
                ceoStatusEl.textContent = 'Target met';
                ceoStatusEl.style.background = 'var(--bg-secondary)';
                ceoStatusEl.style.color = 'var(--text-secondary)';
            } else if (target > 0 && convs >= target * 0.5) {
                ceoStatusEl.textContent = 'In Progress';
                ceoStatusEl.style.background = 'var(--bg-secondary)';
                ceoStatusEl.style.color = 'var(--text-muted)';
            } else if (target > 0) {
                ceoStatusEl.textContent = 'Below Target';
                ceoStatusEl.style.background = 'var(--bg-secondary)';
                ceoStatusEl.style.color = 'var(--text-muted)';
            } else {
                ceoStatusEl.textContent = 'Not Configured';
                ceoStatusEl.style.background = 'var(--card-bg)';
                ceoStatusEl.style.color = 'var(--text-muted)';
            }
            
            // Identity bar (shows across all tabs after onboarding)
            const idBar = document.getElementById('identityBar');
            if (state.onboardingComplete && state.profile.lane) {
                idBar.style.display = 'block';
                document.getElementById('idLane').textContent = state.profile.lane;
                document.getElementById('idCalmNumber').textContent = target > 0 ? target : '‚Äî';
                document.getElementById('idWeekOf').textContent = state.currentWeek;
            } else {
                idBar.style.display = 'none';
            }
            
            // Lane Why reminder in Stall Protocol
            const laneWhyReminder = document.getElementById('laneWhyReminder');
            if (state.profile.laneWhy && state.profile.lane) {
                document.getElementById('stallLane').textContent = state.profile.lane;
                document.getElementById('stallLaneWhy').textContent = '"' + state.profile.laneWhy + '"';
                laneWhyReminder.style.display = 'block';
            } else {
                laneWhyReminder.style.display = 'none';
            }
            
            // Recommended action
            updateRecommendedAction();
        }

        function updateRecommendedAction() {
            const actions = [];
            if (!state.plan.weekly_conversations) {
                actions.push('Complete your Plan Builder to activate your Command Center.');
            } else {
                const thisWeek = state.weekly[state.currentWeek] || {};
                if (!thisWeek.completed) actions.push('Log your weekly scorecard.');
                if (actions.length === 0) actions.push(`Hit your Calm Number: ${state.plan.weekly_conversations} conversations this week.`);
            }
            document.getElementById('recommendedAction').textContent = actions[0];
        }

        function calculateYTDGCI() {
            let total = 0;
            const months = ['01','02','03','04','05','06','07','08','09','10','11','12'];
            const year = state.year;
            months.forEach(m => {
                const key = `${year}-${m}`;
                if (state.gci[key]) {
                    total += parseFloat(state.gci[key].actual?.replace(/[^0-9.]/g, '') || 0);
                }
            });
            return total;
        }

        // Computed, not incremented - prevents inflation
        function computeWeeksCompleted() {
            if (!state.weekly) return 0;
            return Object.values(state.weekly).filter(w => w.completed === true).length;
        }

        // ==================== WEEKLY SCORECARD ====================
        function initWeeklyScorecard() {
            state.currentWeek = state.currentWeek || getWeekKey(new Date());
            renderWeeklyScorecard();
        }

        function renderWeeklyScorecard() {
            document.getElementById('currentWeekLabel').textContent = getWeekLabel(state.currentWeek);
            document.getElementById('weekConvTarget').textContent = state.plan.weekly_conversations || '8';
            
            const weekData = state.weekly[state.currentWeek] || {};
            
            // Metrics
            document.getElementById('week_conversations').value = weekData.conversations || '';
            document.getElementById('week_appointments').value = weekData.appointments || '';
            document.getElementById('week_sphere').value = weekData.sphere || '';
            document.getElementById('week_dbSize').value = weekData.dbSize || '';
            document.getElementById('week_dbTouched').value = weekData.dbTouched || '';
            document.getElementById('week_win').value = weekData.win || '';
            document.getElementById('week_lesson').value = weekData.lesson || '';
            
            // Checkboxes - BUG FIX: proper event handling
            ['ceoHour', 'visibility', 'followups', 'hitTarget', 'referralAsk'].forEach(field => {
                const el = document.getElementById('week_' + field);
                const row = el.closest('.check-row');
                el.checked = weekData[field] || false;
                row.classList.toggle('completed', el.checked);
            });
            
            // Weeks Completed (computed, not stored)
            document.getElementById('weeksCompleted').textContent = computeWeeksCompleted();
            
            // Database health meter
            updateDbHealthMeter();
        }

        function changeWeek(delta) {
            // Parse date properly to avoid timezone issues
            const parts = state.currentWeek.split('-');
            const current = new Date(parts[0], parts[1] - 1, parts[2]);
            current.setDate(current.getDate() + (delta * 7));
            state.currentWeek = getWeekKey(current);
            saveState();
            renderWeeklyScorecard();
        }

        function saveWeeklyField(field) {
            if (!state.weekly[state.currentWeek]) state.weekly[state.currentWeek] = {};
            const el = document.getElementById('week_' + field);
            state.weekly[state.currentWeek][field] = el.value;
            saveState();
        }

        // BUG FIX: Stop propagation on checkbox click
        function toggleWeeklyCheck(field, event) {
            if (event.target.type === 'checkbox') {
                event.stopPropagation();
            }
            
            if (!state.weekly[state.currentWeek]) state.weekly[state.currentWeek] = {};
            const el = document.getElementById('week_' + field);
            
            // If not clicking directly on checkbox, toggle it
            if (event.target.type !== 'checkbox') {
                el.checked = !el.checked;
            }
            
            state.weekly[state.currentWeek][field] = el.checked;
            el.closest('.check-row').classList.toggle('completed', el.checked);
            saveState();
        }

        function updateDbHealthMeter() {
            const dbSize = parseFloat(document.getElementById('week_dbSize').value) || 0;
            const touched = parseFloat(document.getElementById('week_dbTouched').value) || 0;
            
            let percent = dbSize > 0 ? Math.round((touched / dbSize) * 100) : 0;
            percent = Math.min(percent, 100);
            
            const fill = document.getElementById('dbMeterFill');
            const label = document.getElementById('dbMeterPercent');
            
            fill.style.width = percent + '%';
            label.textContent = percent + '%';
            
            fill.classList.remove('success', 'warning', 'danger');
            if (percent >= 10) fill.classList.add('success');
            else if (percent >= 5) fill.classList.add('warning');
            else fill.classList.add('danger');
        }

        function completeWeek() {
            if (!state.weekly[state.currentWeek]) state.weekly[state.currentWeek] = {};
            
            const convs = parseInt(document.getElementById('week_conversations').value) || 0;
            const target = parseInt(state.plan.weekly_conversations) || 0;
            const hitTarget = convs >= target && target > 0;
            
            // Update hitTarget checkbox
            document.getElementById('week_hitTarget').checked = hitTarget;
            state.weekly[state.currentWeek].hitTarget = hitTarget;
            
            state.weekly[state.currentWeek].completed = true;
            state.weekly[state.currentWeek].completedDate = new Date().toISOString();
            
            saveState();
            
            // Intentional silence moment
            showWeekClosureOverlay();
        }
        
        function showWeekClosureOverlay() {
            const overlay = document.createElement('div');
            overlay.id = 'weekClosureOverlay';
            overlay.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-primary); display: flex; align-items: center; justify-content: center; z-index: 10000; opacity: 0; transition: opacity 0.3s ease;';
            overlay.innerHTML = `
                <div style="text-align: center;">
                    <p style="font-size: 1.25rem; color: var(--text-primary); font-weight: 500;">Week closed.</p>
                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.5rem;">Execution compounds quietly.</p>
                </div>
            `;
            document.body.appendChild(overlay);
            
            // Fade in
            requestAnimationFrame(() => overlay.style.opacity = '1');
            
            // After 2.5 seconds, fade out and remove
            setTimeout(() => {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.remove();
                    renderWeeklyScorecard();
                    updateCommandCenter();
                }, 300);
            }, 2500);
        }

        // ==================== PIPELINE ====================
        let editingDealId = null;

        function initPipeline() {
            renderPipeline();
        }

        function renderPipeline() {
            const stages = [
                { id: 'lead', name: 'Lead', icon: '‚óã' },
                { id: 'nurturing', name: 'Nurturing', icon: '‚óê' },
                { id: 'active', name: 'Active Search', icon: '‚óë' },
                { id: 'contract', name: 'Under Contract', icon: '‚óï' },
                { id: 'closed', name: 'Closed', icon: '‚óè' }
            ];
            
            // Update stats
            const activeDeals = state.deals.filter(d => d.stage !== 'closed');
            const closedDeals = state.deals.filter(d => d.stage === 'closed');
            
            document.getElementById('pipelineActiveCount').textContent = activeDeals.length;
            document.getElementById('pipelineProjectedGCI').textContent = '$' + 
                activeDeals.reduce((sum, d) => sum + parseFloat(d.gci?.replace(/[^0-9.]/g, '') || 0), 0).toLocaleString();
            document.getElementById('pipelineClosedYTD').textContent = closedDeals.length;
            document.getElementById('pipelineGCIYTD').textContent = '$' + 
                closedDeals.reduce((sum, d) => sum + parseFloat(d.gci?.replace(/[^0-9.]/g, '') || 0), 0).toLocaleString();
            
            // Render stages
            document.getElementById('pipelineStages').innerHTML = stages.map(stage => {
                const deals = state.deals.filter(d => d.stage === stage.id);
                return `
                    <div class="pipeline-stage">
                        <div class="stage-header">
                            <span class="stage-title">${stage.icon} ${stage.name}</span>
                            <span class="stage-count">${deals.length}</span>
                        </div>
                        <div class="stage-deals">
                            ${deals.map(deal => {
                                let closeDateDisplay = '‚Äî';
                                if (deal.closeDate) {
                                    const parts = deal.closeDate.split('-');
                                    const d = new Date(parts[0], parts[1] - 1, parts[2]);
                                    closeDateDisplay = d.toLocaleDateString('en-US', {month: 'short', day: 'numeric'});
                                }
                                return `
                                <div class="deal-card" onclick="editDeal('${deal.id}')">
                                    <div class="deal-name">${deal.type === 'buyer' ? 'üè†' : 'üìã'} ${deal.name}</div>
                                    <div class="deal-meta">
                                        <span>${closeDateDisplay}</span>
                                        <span class="deal-gci">${deal.gci || '‚Äî'}</span>
                                    </div>
                                </div>
                            `}).join('')}
                        </div>
                        <button class="stage-add" onclick="openDealModal('${stage.id}')">+ Add Deal</button>
                    </div>
                `;
            }).join('');
        }

        function openDealModal(stage) {
            editingDealId = null;
            document.getElementById('dealModalTitle').textContent = 'Add Deal';
            document.getElementById('deal_name').value = '';
            document.getElementById('deal_stage').value = stage || 'lead';
            document.getElementById('deal_type').value = 'buyer';
            document.getElementById('deal_gci').value = '';
            document.getElementById('deal_closeDate').value = '';
            document.getElementById('deal_source').value = '';
            document.getElementById('dealDeleteBtn').style.display = 'none';
            document.getElementById('dealModal').classList.remove('hidden');
        }

        function editDeal(id) {
            const deal = state.deals.find(d => d.id === id);
            if (!deal) return;
            
            editingDealId = id;
            document.getElementById('dealModalTitle').textContent = 'Edit Deal';
            document.getElementById('deal_name').value = deal.name || '';
            document.getElementById('deal_stage').value = deal.stage || 'lead';
            document.getElementById('deal_type').value = deal.type || 'buyer';
            document.getElementById('deal_gci').value = deal.gci || '';
            document.getElementById('deal_closeDate').value = deal.closeDate || '';
            document.getElementById('deal_source').value = deal.source || '';
            document.getElementById('dealDeleteBtn').style.display = 'block';
            document.getElementById('dealModal').classList.remove('hidden');
        }

        function closeDealModal() {
            document.getElementById('dealModal').classList.add('hidden');
            editingDealId = null;
        }

        function saveDeal() {
            const deal = {
                id: editingDealId || Date.now().toString(),
                name: document.getElementById('deal_name').value,
                stage: document.getElementById('deal_stage').value,
                type: document.getElementById('deal_type').value,
                gci: document.getElementById('deal_gci').value,
                closeDate: document.getElementById('deal_closeDate').value,
                source: document.getElementById('deal_source').value
            };
            
            if (editingDealId) {
                const idx = state.deals.findIndex(d => d.id === editingDealId);
                if (idx >= 0) state.deals[idx] = deal;
            } else {
                state.deals.push(deal);
            }
            
            saveState();
            closeDealModal();
            renderPipeline();
            updateCommandCenter();
        }

        function deleteDeal() {
            if (!editingDealId) return;
            if (!confirm('Delete this deal?')) return;
            
            state.deals = state.deals.filter(d => d.id !== editingDealId);
            saveState();
            closeDealModal();
            renderPipeline();
            updateCommandCenter();
        }

        // ==================== GCI TRACKER ====================
        function initGCITracker() {
            renderGCITracker();
        }

        function renderGCITracker() {
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                           'July', 'August', 'September', 'October', 'November', 'December'];
            const year = state.year;
            const goal = parseFloat(state.profile.incomeGoal?.replace(/[^0-9.]/g, '') || 0);
            const monthlyGoal = goal / 12;
            
            // Calculate totals
            let actualYTD = 0;
            let targetYTD = 0;
            const now = new Date();
            const currentMonth = now.getMonth();
            
            months.forEach((m, idx) => {
                const key = `${year}-${String(idx + 1).padStart(2, '0')}`;
                const monthData = state.gci[key] || {};
                actualYTD += parseFloat(monthData.actual?.replace(/[^0-9.]/g, '') || 0);
                if (idx <= currentMonth) targetYTD += monthlyGoal;
            });
            
            // Update summary
            document.getElementById('gciGoal').textContent = '$' + goal.toLocaleString();
            document.getElementById('gciActualYTD').textContent = '$' + Math.round(actualYTD).toLocaleString();
            document.getElementById('gciRemaining').textContent = '$' + Math.max(0, Math.round(goal - actualYTD)).toLocaleString();
            document.getElementById('gciPacePercent').textContent = goal > 0 ? Math.round(actualYTD / goal * 100) + '%' : '0%';
            document.getElementById('gciProgressBar').style.width = goal > 0 ? Math.min(100, actualYTD / goal * 100) + '%' : '0%';
            
            // Render months
            document.getElementById('gciMonths').innerHTML = months.map((month, idx) => {
                const key = `${year}-${String(idx + 1).padStart(2, '0')}`;
                const monthData = state.gci[key] || {};
                const target = parseFloat(monthData.target?.replace(/[^0-9.]/g, '') || monthlyGoal);
                const actual = parseFloat(monthData.actual?.replace(/[^0-9.]/g, '') || 0);
                const onTrack = actual >= target;
                const isPast = idx < currentMonth;
                
                return `
                    <div class="gci-month-card">
                        <div class="gci-month-header">
                            <span class="gci-month-name">${month}</span>
                            ${isPast ? `<span class="gci-month-progress ${onTrack ? 'on-track' : 'behind'}">${onTrack ? 'Target met' : '‚Üì Behind'}</span>` : ''}
                        </div>
                        <div class="gci-row">
                            <label>Target</label>
                            <input type="text" id="gci_target_${key}" value="${monthData.target || '$' + Math.round(monthlyGoal).toLocaleString()}" 
                                   onchange="saveGCIField('${key}', 'target')">
                        </div>
                        <div class="gci-row">
                            <label>Actual</label>
                            <input type="text" id="gci_actual_${key}" value="${monthData.actual || ''}" 
                                   onchange="saveGCIField('${key}', 'actual')" placeholder="$0">
                        </div>
                        <div class="progress-bar" style="margin-top: 0.5rem;">
                            <div class="progress-fill" style="width: ${target > 0 ? Math.min(100, actual / target * 100) : 0}%; background: ${onTrack ? 'var(--success)' : 'var(--warning)'};"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function saveGCIField(monthKey, field) {
            if (!state.gci[monthKey]) state.gci[monthKey] = {};
            const el = document.getElementById(`gci_${field}_${monthKey}`);
            state.gci[monthKey][field] = el.value;
            saveState();
            renderGCITracker();
            updateCommandCenter();
        }

        // ==================== VISIBILITY PLANNER ====================
        function initVisibilityPlanner() {
            state.currentVisibilityMonth = state.currentVisibilityMonth || new Date().toISOString().slice(0, 7);
            renderVisibilityPlanner();
        }

        function renderVisibilityPlanner() {
            const [year, month] = state.currentVisibilityMonth.split('-').map(Number);
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            
            document.getElementById('visibilityMonthLabel').textContent = `${monthNames[month - 1]} ${year}`;
            
            // Calculate stats
            const monthData = state.visibility[state.currentVisibilityMonth] || {};
            const daysInMonth = new Date(year, month, 0).getDate();
            const doneCount = Object.values(monthData).filter(v => v.completed).length;
            
            document.getElementById('visibilityDone').textContent = doneCount;
            document.getElementById('visibilityTotal').textContent = daysInMonth;
            document.getElementById('visibilityRate').textContent = Math.round(doneCount / daysInMonth * 100) + '%';
            
            // Build calendar
            const firstDay = new Date(year, month - 1, 1).getDay(); // 0 = Sunday
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            let html = dayHeaders.map(d => `<div class="calendar-header">${d}</div>`).join('');
            
            // Empty cells before first day
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="calendar-day empty"></div>';
            }
            
            // Days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${day}`;
                const dayData = monthData[dateKey] || {};
                const completed = dayData.completed;
                const action = dayData.action || '';
                
                html += `
                    <div class="calendar-day ${completed ? 'completed' : ''}" onclick="openVisibilityModal('${dateKey}')">
                        <div class="calendar-day-number">${day}</div>
                        <div class="calendar-day-action">${action || ''}</div>
                    </div>
                `;
            }
            
            document.getElementById('visibilityCalendar').innerHTML = html;
        }

        function changeVisibilityMonth(delta) {
            const [year, month] = state.currentVisibilityMonth.split('-').map(Number);
            const newDate = new Date(year, month - 1 + delta, 1);
            state.currentVisibilityMonth = newDate.toISOString().slice(0, 7);
            saveState();
            renderVisibilityPlanner();
        }

        let currentVisibilityDay = null;

        function openVisibilityModal(day) {
            currentVisibilityDay = day;
            const monthData = state.visibility[state.currentVisibilityMonth] || {};
            const dayData = monthData[day] || {};
            
            document.getElementById('visibilityModalTitle').textContent = `Visibility Action - Day ${day}`;
            document.getElementById('visibility_action').value = dayData.action || '';
            document.getElementById('visibility_completed').checked = dayData.completed || false;
            document.getElementById('visibilityModal').classList.remove('hidden');
        }

        function closeVisibilityModal() {
            document.getElementById('visibilityModal').classList.add('hidden');
            currentVisibilityDay = null;
        }

        function saveVisibilityAction() {
            if (!currentVisibilityDay) return;
            
            if (!state.visibility[state.currentVisibilityMonth]) {
                state.visibility[state.currentVisibilityMonth] = {};
            }
            
            state.visibility[state.currentVisibilityMonth][currentVisibilityDay] = {
                action: document.getElementById('visibility_action').value,
                completed: document.getElementById('visibility_completed').checked
            };
            
            saveState();
            closeVisibilityModal();
            renderVisibilityPlanner();
            updateCommandCenter();
        }

        // ==================== MONTHLY ACTIVITY CALENDAR ====================
        function initActivityCalendar() {
            state.currentActivityMonth = state.currentActivityMonth || new Date().toISOString().slice(0, 7);
            renderActivityCalendar();
        }

        function renderActivityCalendar() {
            const [year, month] = state.currentActivityMonth.split('-').map(Number);
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            
            document.getElementById('activityMonthLabel').textContent = `${monthNames[month - 1]} ${year}`;
            
            // Get daily target from Calm Number (weekly / 5 workdays, rounded up)
            const weeklyTarget = parseInt(state.plan.weekly_conversations) || 8;
            const dailyTarget = Math.ceil(weeklyTarget / 5);
            
            // Calculate stats
            const daysInMonth = new Date(year, month, 0).getDate();
            let totalConvos = 0;
            let daysHit = 0;
            let daysLogged = 0;
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const count = state.activity[dateStr];
                if (count !== undefined) {
                    totalConvos += count;
                    daysLogged++;
                    if (count >= dailyTarget) daysHit++;
                }
            }
            
            const avgDaily = daysLogged > 0 ? (totalConvos / daysLogged).toFixed(1) : 0;
            
            document.getElementById('activityDaysHit').textContent = daysHit;
            document.getElementById('activityTotalConvos').textContent = totalConvos;
            document.getElementById('activityAvgDaily').textContent = avgDaily;
            
            // Build calendar
            const firstDay = new Date(year, month - 1, 1).getDay(); // 0 = Sunday
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            let html = dayHeaders.map(d => `<div class="calendar-header">${d}</div>`).join('');
            
            // Empty cells before first day
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="calendar-day empty"></div>';
            }
            
            // Days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const count = state.activity[dateStr];
                const hasData = count !== undefined;
                
                let statusClass = '';
                let statusColor = '';
                if (hasData) {
                    if (count >= dailyTarget) {
                        statusClass = 'hit';
                        statusColor = 'var(--success)';
                    } else if (count >= dailyTarget - 1) {
                        statusClass = 'close';
                        statusColor = 'var(--warning)';
                    } else {
                        statusClass = 'missed';
                        statusColor = 'var(--danger)';
                    }
                }
                
                html += `
                    <div class="calendar-day activity-day ${statusClass}" 
                         style="${hasData ? 'border-color: ' + statusColor + '; background: ' + statusColor + '20;' : ''}"
                         onclick="openActivityModal('${dateStr}', ${day})">
                        <div class="calendar-day-number">${day}</div>
                        <div class="calendar-day-action" style="${hasData ? 'color: ' + statusColor + '; font-weight: 600;' : ''}">
                            ${hasData ? count + ' convos' : ''}
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('activityCalendar').innerHTML = html;
        }

        function changeActivityMonth(delta) {
            const [year, month] = state.currentActivityMonth.split('-').map(Number);
            const newDate = new Date(year, month - 1 + delta, 1);
            state.currentActivityMonth = newDate.toISOString().slice(0, 7);
            saveState();
            renderActivityCalendar();
        }

        let currentActivityDate = null;

        function openActivityModal(dateStr, day) {
            currentActivityDate = dateStr;
            const count = state.activity[dateStr] || 0;
            const weeklyTarget = parseInt(state.plan.weekly_conversations) || 8;
            const dailyTarget = Math.ceil(weeklyTarget / 5);
            
            document.getElementById('activityModalTitle').textContent = `Conversations - Day ${day}`;
            document.getElementById('activity_count').value = count || '';
            document.getElementById('activity_target').textContent = dailyTarget;
            document.getElementById('activityModal').classList.remove('hidden');
        }

        function closeActivityModal() {
            document.getElementById('activityModal').classList.add('hidden');
            currentActivityDate = null;
        }

        function saveActivityCount() {
            if (!currentActivityDate) return;
            
            const count = parseInt(document.getElementById('activity_count').value) || 0;
            state.activity[currentActivityDate] = count;
            
            saveState();
            closeActivityModal();
            renderActivityCalendar();
            updateCommandCenter();
        }

        // ==================== 90-DAY REVIEW ====================
        function initSprintReview() {
            renderSprintSelector();
            renderSprintContent();
        }

        function renderSprintSelector() {
            const sprints = ['Q1', 'Q2', 'Q3', 'Q4'];
            document.getElementById('sprintSelector').innerHTML = sprints.map(sprint => {
                const data = state.sprints[sprint] || {};
                const isActive = sprint === state.currentSprint;
                const isComplete = data.completed;
                return `
                    <button class="sprint-btn ${isActive ? 'active' : ''} ${isComplete ? 'completed' : ''}" 
                            onclick="selectSprint('${sprint}')">${sprint}</button>
                `;
            }).join('');
        }

        function selectSprint(sprint) {
            state.currentSprint = sprint;
            renderSprintSelector();
            renderSprintContent();
        }

        function renderSprintContent() {
            const sprint = state.currentSprint;
            const data = state.sprints[sprint] || {};
            const container = document.getElementById('sprintContent');
            
            container.innerHTML = `
                <div class="sprint-section">
                    <div class="sprint-section-title">üéØ 90-Day Focus</div>
                    <div class="form-group">
                        <label>What is the ONE thing you're focusing on this quarter?</label>
                        <input type="text" id="sprint_focus" value="${data.focus || ''}" 
                               onchange="saveSprintField('focus')" placeholder="e.g., Build first-time buyer pipeline">
                    </div>
                    <div class="form-group">
                        <label>How will you know you succeeded?</label>
                        <textarea id="sprint_successMetric" onchange="saveSprintField('successMetric')"
                                  placeholder="e.g., 3 buyer closings from this segment">${data.successMetric || ''}</textarea>
                    </div>
                </div>

                <div class="sprint-section">
                    <div class="sprint-section-title">The Numbers (${sprint} Targets)</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Target Closings</label>
                            <input type="number" id="sprint_targetClosings" value="${data.targetClosings || ''}" 
                                   onchange="saveSprintField('targetClosings')">
                        </div>
                        <div class="form-group">
                            <label>Target GCI</label>
                            <input type="text" id="sprint_targetGCI" value="${data.targetGCI || ''}" 
                                   onchange="saveSprintField('targetGCI')" placeholder="e.g., $40,000">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Actual Closings</label>
                            <input type="number" id="sprint_actualClosings" value="${data.actualClosings || ''}" 
                                   onchange="saveSprintField('actualClosings')">
                        </div>
                        <div class="form-group">
                            <label>Actual GCI</label>
                            <input type="text" id="sprint_actualGCI" value="${data.actualGCI || ''}" 
                                   onchange="saveSprintField('actualGCI')">
                        </div>
                    </div>
                </div>

                <div class="sprint-section">
                    <div class="sprint-section-title">üîÑ Stop / Start / Continue</div>
                    <div class="review-grid">
                        <div class="review-column">
                            <div class="review-column-title stop">üõë Stop</div>
                            <textarea id="sprint_stop" onchange="saveSprintField('stop')"
                                      placeholder="What's not working that you need to drop?"
                                      style="min-height: 120px; font-size: 0.875rem;">${data.stop || ''}</textarea>
                        </div>
                        <div class="review-column">
                            <div class="review-column-title start">üü¢ Start</div>
                            <textarea id="sprint_start" onchange="saveSprintField('start')"
                                      placeholder="What new action will you commit to?"
                                      style="min-height: 120px; font-size: 0.875rem;">${data.start || ''}</textarea>
                        </div>
                        <div class="review-column">
                            <div class="review-column-title continue">üîµ Continue</div>
                            <textarea id="sprint_continue" onchange="saveSprintField('continue')"
                                      placeholder="What worked this quarter?"
                                      style="min-height: 120px; font-size: 0.875rem;">${data.continue || ''}</textarea>
                        </div>
                    </div>
                </div>

                <div class="sprint-section">
                    <div class="sprint-section-title">üí≠ Quarter Reflection</div>
                    <div class="form-group">
                        <label>Biggest result this quarter?</label>
                        <input type="text" id="sprint_biggestWin" value="${data.biggestWin || ''}" 
                               onchange="saveSprintField('biggestWin')">
                    </div>
                    <div class="form-group">
                        <label>Biggest lesson learned?</label>
                        <textarea id="sprint_lessonLearned" onchange="saveSprintField('lessonLearned')">${data.lessonLearned || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Should you pivot your strategy?</label>
                        <div class="ceo-line" style="margin-bottom: 1rem;">
                            "Only pivot if: (1) You've executed consistently for 90 days, AND (2) Data supports the change. Boredom is not a business signal."
                        </div>
                        <textarea id="sprint_pivotThoughts" onchange="saveSprintField('pivotThoughts')"
                                  placeholder="If pivoting, what specifically and why?">${data.pivotThoughts || ''}</textarea>
                    </div>
                </div>

                <div class="sprint-section" style="border: 1px solid var(--warning); background: rgba(245, 158, 11, 0.05);">
                    <div class="sprint-section-title">üõ§Ô∏è Lane Status</div>
                    <div style="margin-bottom: 1rem;">
                        <span style="color: var(--text-secondary);">Current Lane:</span>
                        <strong style="color: var(--accent);">${state.profile?.lane || '‚Äî'}</strong>
                        <span style="color: var(--text-muted); font-size: 0.8rem; margin-left: 0.5rem;">
                            (locked ${state.profile?.laneLockDate ? new Date(state.profile.laneLockDate).toLocaleDateString() : '‚Äî'})
                        </span>
                    </div>
                    <div class="ceo-line" style="margin-bottom: 1rem;">
                        "THE LANE doesn't change mid-quarter. If you must switch, do it here ‚Äî with intention."
                    </div>
                    <details style="margin-top: 1rem;">
                        <summary style="cursor: pointer; color: var(--warning); font-weight: 600;">Request Lane Change (use sparingly)</summary>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--card-bg); border-radius: 0.5rem;">
                            <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">
                                Lane changes are logged. Before switching, ask: "Did I actually execute consistently, or am I just bored?"
                            </p>
                            <div class="form-group">
                                <label style="color: var(--warning);">Why are you changing lanes? (Required)</label>
                                <textarea id="laneChangeReason" placeholder="Be specific. Data, not feelings." style="min-height: 80px;"></textarea>
                            </div>
                            <div class="form-group">
                                <label>New Lane</label>
                                <select id="newLaneSelect" style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--card-border);">
                                    <option value="">‚Äî Select new lane ‚Äî</option>
                                    <option value="Sphere/SOI">Sphere/SOI</option>
                                    <option value="Past Clients">Past Clients</option>
                                    <option value="Geographic Farming">Geographic Farming</option>
                                    <option value="Open Houses">Open Houses</option>
                                    <option value="Expired/FSBO">Expired/FSBO</option>
                                    <option value="Builder/New Construction">Builder/New Construction</option>
                                    <option value="Investor Clients">Investor Clients</option>
                                    <option value="First-Time Buyers">First-Time Buyers</option>
                                    <option value="Relocation">Relocation</option>
                                    <option value="Social Media/Content">Social Media/Content</option>
                                    <option value="Paid Leads (Zillow, etc.)">Paid Leads (Zillow, etc.)</option>
                                    <option value="Agent Referrals">Agent Referrals</option>
                                    <option value="Community Events">Community Events</option>
                                    <option value="Door Knocking">Door Knocking</option>
                                    <option value="Other">Other (specify below)</option>
                                </select>
                            </div>
                            <div class="form-group" id="customNewLaneGroup" style="display: none;">
                                <label>Custom Lane Name</label>
                                <input type="text" id="customNewLaneName" placeholder="Your custom lane">
                            </div>
                            <button class="btn btn-secondary" style="border-color: var(--warning); color: var(--warning);" onclick="requestLaneChange()">
                                Submit Lane Change
                            </button>
                        </div>
                    </details>
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="completeSprint()">Close ${sprint} Review</button>
                </div>
                
                <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--card-border); text-align: center;">
                    <p style="color: var(--text-muted); font-size: 0.8rem; margin-bottom: 1rem;">Your data is stored locally in your browser. Back it up periodically.</p>
                    <button class="btn btn-secondary" style="font-size: 0.85rem;" onclick="exportData()">‚Üì Download My Data (JSON)</button>
                </div>
            `;
        }

        function saveSprintField(field) {
            if (!state.sprints[state.currentSprint]) state.sprints[state.currentSprint] = {};
            const el = document.getElementById('sprint_' + field);
            state.sprints[state.currentSprint][field] = el.value;
            saveState();
        }

        function requestLaneChange() {
            const reason = document.getElementById('laneChangeReason').value.trim();
            const newLaneSelect = document.getElementById('newLaneSelect').value;
            const customNewLane = document.getElementById('customNewLaneName')?.value?.trim();
            
            // Validation
            if (!reason || reason.length < 20) {
                alert('Provide a detailed reason (at least 20 characters). Lane changes require intentional reflection.');
                return;
            }
            
            if (!newLaneSelect) {
                alert('Select a new lane.');
                return;
            }
            
            const newLane = newLaneSelect === 'Other' && customNewLane ? customNewLane : newLaneSelect;
            const oldLane = state.profile.lane;
            
            if (newLane === oldLane) {
                alert('That\'s already your current lane. No change needed.');
                return;
            }
            
            // Confirmation
            if (!confirm(`LANE CHANGE REQUEST\n\nFrom: ${oldLane}\nTo: ${newLane}\nReason: ${reason.substring(0, 100)}...\n\nThis will be logged in your audit history.\n\nProceed?`)) {
                return;
            }
            
            // Log to audit
            if (!state.audit) state.audit = [];
            state.audit.push({
                type: 'lane_change',
                date: new Date().toISOString(),
                sprint: state.currentSprint,
                from: oldLane,
                to: newLane,
                reason: reason
            });
            
            // Update lane
            state.profile.lane = newLane;
            state.profile.laneLockDate = new Date().toISOString();
            state.profile.laneChangeCount = (state.profile.laneChangeCount || 0) + 1;
            
            saveState();
            
            // Clear form
            document.getElementById('laneChangeReason').value = '';
            document.getElementById('newLaneSelect').value = '';
            if (document.getElementById('customNewLaneName')) {
                document.getElementById('customNewLaneName').value = '';
            }
            
            // Re-render
            renderSprintContent();
            updateDashboard();
            
            // Close modal quietly - the updated lane panel is confirmation
            closeLaneChangeModal();
        }

        // Show/hide custom lane field in lane change form
        document.addEventListener('change', function(e) {
            if (e.target.id === 'newLaneSelect') {
                const customGroup = document.getElementById('customNewLaneGroup');
                if (customGroup) {
                    customGroup.style.display = e.target.value === 'Other' ? 'block' : 'none';
                }
            }
        });

        function completeSprint() {
            if (!state.sprints[state.currentSprint]) state.sprints[state.currentSprint] = {};
            state.sprints[state.currentSprint].completed = true;
            state.sprints[state.currentSprint].completedDate = new Date().toISOString();
            saveState();
            renderSprintSelector();
            showNotification(`${state.currentSprint} recorded`);
        }

        // ==================== SHARE / EXPORT ====================
        function showShareModal() {
            const report = generateShareReport();
            document.getElementById('sharePreview').textContent = report;
            document.getElementById('shareModal').classList.remove('hidden');
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.add('hidden');
        }

        function generateShareReport() {
            const name = state.profile.name || 'Agent';
            const week = getWeekLabel(state.currentWeek);
            const weekData = state.weekly[state.currentWeek] || {};
            const calmNumber = state.plan.weekly_conversations || 0;
            const convs = weekData.conversations || 0;
            const ytdGCI = calculateYTDGCI();
            const goal = parseFloat(state.profile.incomeGoal?.replace(/[^0-9.]/g, '') || 0);
            const activeDeals = state.deals.filter(d => d.stage !== 'closed').length;
            
            const visMonth = state.visibility[state.currentVisibilityMonth] || {};
            const visDone = Object.values(visMonth).filter(v => v.completed).length;
            const [y, m] = state.currentVisibilityMonth.split('-').map(Number);
            const daysInMonth = new Date(y, m, 0).getDate();
            
            return `THE LANE ‚Äî WEEKLY REPORT
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

${name} | ${week}

EXECUTION
‚Ä¢ Conversations: ${convs} / ${calmNumber} target
‚Ä¢ Weeks Completed: ${computeWeeksCompleted()}
‚Ä¢ CEO Hour: ${weekData.ceoHour ? 'Done' : '‚Äî'}
‚Ä¢ Daily Visibility: ${weekData.visibility ? 'Done' : '‚Äî'}
‚Ä¢ Follow-ups: ${weekData.followups ? 'Done' : '‚Äî'}

INCOME
‚Ä¢ YTD GCI: $${ytdGCI.toLocaleString()}
‚Ä¢ Goal Progress: ${goal > 0 ? Math.round(ytdGCI / goal * 100) : 0}%
‚Ä¢ Active Pipeline: ${activeDeals} deals

VISIBILITY (${state.currentVisibilityMonth})
‚Ä¢ Days Completed: ${visDone} / ${daysInMonth}
‚Ä¢ Rate: ${Math.round(visDone / daysInMonth * 100)}%

RESULT
${weekData.win || '‚Äî'}

Generated: ${new Date().toLocaleDateString()}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ`;
        }

        function copyShareReport() {
            const report = document.getElementById('sharePreview').textContent;
            navigator.clipboard.writeText(report).then(() => {
                showNotification('Copied');
            });
        }

        function exportToPDF() {
            // Use browser print functionality
            window.print();
        }

        // ==================== PLAN BUILDER ====================
        let builderStep = 1;
        const totalBuilderSteps = 14;
        const builderFields = [
            'opening_reflection', 'name', 'email', 'market_area',
            'who_i_serve', 'what_decision', 'who_not_for',
            'voice_feels_like', 'clients_feel', 'go_to_phrases', 'words_avoid',
            'differentiator', 'what_i_believe', 'what_i_refuse',
            'cta_style', 'known_for',
            'business_focus', 'lead_source', 'decision_style',
            'client_fear', 'repeat_explanation', 'why_i_care',
            'decision_trust', 'decision_accuracy', 'decision_education',
            'decision_relationships', 'decision_simplicity', 'decision_consistency',
            'custom_decision',
            'income_goal', 'avg_commission', 'deals_needed', 'appt_ratio',
            'appointments_needed', 'weekly_conversations',
            'ceo_hour_day', 'ceo_hour_time', 'visibility_commitment',
            'thirty_day_focus', 'ignore_distractions'
        ];

        function initPlanBuilder() {
            builderFields.forEach(field => {
                const el = document.getElementById(field);
                if (el && state.plan[field] !== undefined) {
                    if (el.type === 'checkbox') el.checked = state.plan[field];
                    else el.value = state.plan[field];
                }
            });
            
            if (state.profile.name && !state.plan.name) document.getElementById('name').value = state.profile.name;
            if (state.profile.incomeGoal && !state.plan.income_goal) document.getElementById('income_goal').value = state.profile.incomeGoal;
            
            builderFields.forEach(field => {
                const el = document.getElementById(field);
                if (el) {
                    el.addEventListener('change', () => savePlanField(field));
                    el.addEventListener('input', debounce(() => savePlanField(field), 500));
                }
            });
            
            ['income_goal', 'avg_commission', 'appt_ratio'].forEach(field => {
                document.getElementById(field)?.addEventListener('input', calculateMath);
            });
            
            document.querySelectorAll('.decision-option').forEach(option => {
                option.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    this.querySelector('input').checked = this.classList.contains('selected');
                    savePlanField(this.querySelector('input').id);
                });
            });
            
            updateBuilderStep();
        }

        function savePlanField(field) {
            const el = document.getElementById(field);
            if (el) {
                state.plan[field] = el.type === 'checkbox' ? el.checked : el.value;
                saveState();
            }
        }

        function calculateMath() {
            const income = parseFloat(document.getElementById('income_goal').value.replace(/[^0-9.]/g, '')) || 0;
            const commission = parseFloat(document.getElementById('avg_commission').value.replace(/[^0-9.]/g, '')) || 0;
            const apptRatio = parseFloat(document.getElementById('appt_ratio').value) || 4;
            
            if (income && commission) {
                const deals = Math.ceil(income / commission);
                document.getElementById('deals_needed').value = deals;
                state.plan.deals_needed = deals;
                
                const appointments = deals * apptRatio;
                document.getElementById('appointments_needed').value = appointments;
                state.plan.appointments_needed = appointments;
                
                const weekly = Math.ceil(appointments / 52);
                const previousCalmNumber = state.plan.weekly_conversations || 0;
                
                // Calm Number protection: warn if increase >25%
                if (previousCalmNumber > 0 && weekly > previousCalmNumber * 1.25) {
                    const increasePercent = Math.round(((weekly - previousCalmNumber) / previousCalmNumber) * 100);
                    setTimeout(() => {
                        alert(`Calm Number increase: +${increasePercent}%\n\nNew: ${weekly}/week (was ${previousCalmNumber})\n\nConsider sustaining current number before raising.`);
                    }, 100);
                }
                
                document.getElementById('weekly_conversations').value = weekly;
                state.plan.weekly_conversations = weekly;
                state.plan.calmNumberSetDate = new Date().toISOString();
                
                saveState();
            }
        }

        function updateBuilderStep() {
            document.querySelectorAll('.builder-step').forEach(step => {
                step.classList.remove('active');
                if (parseInt(step.dataset.step) === builderStep) step.classList.add('active');
            });
            
            const progress = (builderStep / totalBuilderSteps) * 100;
            document.getElementById('builderProgressFill').style.width = progress + '%';
            document.getElementById('builderProgressText').textContent = `Step ${builderStep} of ${totalBuilderSteps}`;
            
            document.getElementById('builderPrevBtn').style.visibility = builderStep === 1 ? 'hidden' : 'visible';
            document.getElementById('builderNextBtn').textContent = builderStep === totalBuilderSteps ? 'Finish' : 'Continue ‚Üí';
            document.getElementById('builderNav').style.display = builderStep === totalBuilderSteps ? 'none' : 'flex';
            
            if (builderStep === totalBuilderSteps) {
                document.getElementById('finalCalmNumber').textContent = state.plan.weekly_conversations || '‚Äî';
                document.getElementById('finalCeoHour').textContent = state.plan.ceo_hour_day && state.plan.ceo_hour_time ? 
                    `${state.plan.ceo_hour_day}s ${state.plan.ceo_hour_time}` : '‚Äî';
                document.getElementById('finalLane').textContent = state.profile.lane || '‚Äî';
            }
        }

        function nextBuilderStep() {
            if (builderStep < totalBuilderSteps) {
                builderStep++;
                updateBuilderStep();
                window.scrollTo(0, 0);
            }
        }

        function prevBuilderStep() {
            if (builderStep > 1) {
                builderStep--;
                updateBuilderStep();
                window.scrollTo(0, 0);
            }
        }

        function completePlanBuilder() {
            saveState();
            switchTab('command');
            updateCommandCenter();
        }

        // ==================== PULSE CHECK ====================
        const MONTHS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        let currentPulseMonth = new Date().getMonth();

        function initPulseCheck() {
            renderPulseMonthTabs();
            renderPulseContent();
        }

        function renderPulseMonthTabs() {
            document.getElementById('pulseMonthTabs').innerHTML = MONTHS.map((month, idx) => {
                const isActive = idx === currentPulseMonth;
                const data = state.pulse[month] || {};
                const isComplete = data.completed;
                return `
                    <button class="month-tab ${isActive ? 'active' : ''} ${isComplete ? 'completed' : ''}" 
                            onclick="selectPulseMonth(${idx})">${month}</button>
                `;
            }).join('');
        }

        function selectPulseMonth(idx) {
            currentPulseMonth = idx;
            renderPulseMonthTabs();
            renderPulseContent();
        }

        function renderPulseContent() {
            const month = MONTHS[currentPulseMonth];
            const data = state.pulse[month] || {};
            
            document.getElementById('pulseContent').innerHTML = `
                <div class="card" style="margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 1rem;">Energy Check</h4>
                    <div class="form-group">
                        <label>Current energy level</label>
                        <div class="radio-group">
                            ${['5 ‚Äî High', '4 ‚Äî Good', '3 ‚Äî Okay', '2 ‚Äî Low', '1 ‚Äî Depleted'].map(opt => `
                                <label class="radio-option ${data.energy === opt ? 'selected' : ''}" onclick="savePulseField('${month}', 'energy', '${opt}')">
                                    <input type="radio" name="energy" ${data.energy === opt ? 'checked' : ''}>${opt}
                                </label>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 1rem;">Monthly Reflection</h4>
                    <div class="form-group">
                        <label>What went well?</label>
                        <textarea id="pulse_wins_${month}" onchange="savePulseField('${month}', 'wins', this.value)">${data.wins || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label>What was challenging?</label>
                        <textarea id="pulse_challenges_${month}" onchange="savePulseField('${month}', 'challenges', this.value)">${data.challenges || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label>What will you focus on next month?</label>
                        <textarea id="pulse_nextFocus_${month}" onchange="savePulseField('${month}', 'nextFocus', this.value)">${data.nextFocus || ''}</textarea>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="completePulseMonth('${month}')">Close ${month} Check-In</button>
            `;
        }

        function savePulseField(month, field, value) {
            if (!state.pulse[month]) state.pulse[month] = {};
            state.pulse[month][field] = value;
            saveState();
            renderPulseContent();
        }

        function completePulseMonth(month) {
            if (!state.pulse[month]) state.pulse[month] = {};
            state.pulse[month].completed = true;
            state.pulse[month].completedDate = new Date().toISOString();
            saveState();
            renderPulseMonthTabs();
            showNotification(`${month} recorded`);
        }

        // ==================== STANDARDS ====================
        const STANDARDS = [
            { id: 1, title: 'I have a written plan', truth: 'Hope is not a strategy.' },
            { id: 2, title: 'I know my Calm Number', truth: 'The math removes emotion.' },
            { id: 3, title: 'I protect my CEO Hour', truth: 'What gets scheduled gets done.' },
            { id: 4, title: 'I show up visible every day', truth: 'Consistency compounds.' },
            { id: 5, title: 'I follow up systematically', truth: 'Fortune is in the follow-up.' },
            { id: 6, title: 'I track my pipeline', truth: 'What gets measured gets managed.' },
            { id: 7, title: 'I touch my database weekly', truth: 'Your database is your business.' },
            { id: 8, title: 'I ask for referrals', truth: 'Referrals are earned, not hoped for.' },
            { id: 9, title: 'I invest in my education', truth: 'Skills pay the bills.' },
            { id: 10, title: 'I take care of my health', truth: 'You can\'t pour from an empty cup.' },
            { id: 11, title: 'I have boundaries', truth: 'No is a complete sentence.' },
            { id: 12, title: 'I acknowledge completions', truth: 'Closing loops matters.' },
            { id: 13, title: 'I learn from losses', truth: 'Every setback is a setup.' },
            { id: 14, title: 'I stay coachable', truth: 'The best are always learning.' }
        ];

        function initStandards() {
            document.getElementById('standardsContent').innerHTML = STANDARDS.map(std => {
                const data = state.standards[std.id] || {};
                const isComplete = data.acknowledged;
                return `
                    <div class="standard-card ${isComplete ? 'complete' : ''}" id="standard-${std.id}">
                        <div class="standard-header" onclick="toggleStandard(${std.id})">
                            <div class="standard-title">
                                <div class="standard-number">${std.id}</div>
                                <span>${std.title}</span>
                            </div>
                            <span style="color: var(--text-muted);">‚ñº</span>
                        </div>
                        <div class="standard-content">
                            <p class="standard-truth">"${std.truth}"</p>
                            <div class="form-group">
                                <label>Your commitment:</label>
                                <textarea id="standard_notes_${std.id}" onchange="saveStandardNotes(${std.id}, this.value)"
                                          placeholder="How will you uphold this standard?">${data.notes || ''}</textarea>
                            </div>
                            <button class="btn btn-sm ${isComplete ? 'btn-secondary' : 'btn-primary'}" 
                                    onclick="acknowledgeStandard(${std.id})">
                                ${isComplete ? 'Recorded' : 'Record Commitment'}
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleStandard(id) {
            document.getElementById(`standard-${id}`).classList.toggle('open');
        }

        function saveStandardNotes(id, notes) {
            if (!state.standards[id]) state.standards[id] = {};
            state.standards[id].notes = notes;
            saveState();
        }

        function acknowledgeStandard(id) {
            if (!state.standards[id]) state.standards[id] = {};
            state.standards[id].acknowledged = true;
            state.standards[id].acknowledgedDate = new Date().toISOString();
            saveState();
            initStandards();
        }

        // ==================== PROMPTS ====================
        function initPrompts() {
            const categories = [
                {
                    name: 'Content Creation',
                    prompts: [
                        { title: 'Social Media Post', prompt: `Write a social media post for a real estate agent with this voice:\n\nVoice: ${state.plan.voice_feels_like || '[Your voice]'}\nAudience: ${state.plan.who_i_serve || '[Your ideal client]'}\nTopic: [Insert topic]\n\nMake it feel like them, not like marketing.` },
                        { title: 'Market Update', prompt: `Create a market update for ${state.plan.market_area || '[Your market]'} that:\n- Uses plain language\n- Explains what it means for ${state.plan.who_i_serve || 'buyers/sellers'}\n- Ends with insight, not a sales pitch\n\nVoice: ${state.plan.voice_feels_like || '[Your voice]'}` },
                        { title: 'Video Script', prompt: `Write a 60-second video script about [topic] for:\n\nAgent: ${state.plan.name || 'Agent'}\nAudience: ${state.plan.who_i_serve || '[Your audience]'}\nVoice: ${state.plan.voice_feels_like || '[Your voice]'}\n\nKeep it conversational. No jargon. One clear takeaway.` }
                    ]
                },
                {
                    name: 'Client Communication',
                    prompts: [
                        { title: 'Follow-Up Email', prompt: `Write a follow-up email for a ${state.plan.who_i_serve || 'client'} who:\n[Describe situation]\n\nVoice: ${state.plan.voice_feels_like || '[Your voice]'}\nGoal: Re-engage without pressure\n\nAvoid: ${state.plan.words_avoid || 'Salesy language'}` },
                        { title: 'Objection Response', prompt: `Help me respond to this objection: [Insert objection]\n\nMy client: ${state.plan.who_i_serve || '[Client type]'}\nMy differentiator: ${state.plan.differentiator || '[Your differentiator]'}\n\nRespond with empathy, then pivot to value.` }
                    ]
                },
                {
                    name: 'Business Planning',
                    prompts: [
                        { title: 'Weekly Review', prompt: `Help me review my week:\n\nCalm Number target: ${state.plan.weekly_conversations || 8}\nActual conversations: [Number]\nAppointments set: [Number]\n\nWhat patterns do you see? What should I adjust?` },
                        { title: 'Quarterly Planning', prompt: `Help me plan next quarter:\n\nCurrent focus: ${state.plan.business_focus || '[Focus]'}\nIncome goal: ${state.profile.incomeGoal || '[Goal]'}\nBiggest challenge: [Describe]\n\nGive me 3 priorities and why.` }
                    ]
                }
            ];

            document.getElementById('promptsContent').innerHTML = categories.map(cat => `
                <div class="prompt-category">
                    <h3 class="prompt-category-title">${cat.name}</h3>
                    ${cat.prompts.map((p, idx) => `
                        <div class="prompt-card" id="prompt-${cat.name}-${idx}">
                            <div class="prompt-header" onclick="togglePrompt('${cat.name}-${idx}')">
                                <span class="prompt-title">${p.title}</span>
                                <span class="prompt-toggle">‚ñº</span>
                            </div>
                            <div class="prompt-content">
                                <div class="prompt-text">${p.prompt}</div>
                                <button class="btn btn-sm btn-secondary" onclick="copyPrompt(\`${p.prompt.replace(/`/g, '\\`')}\`)">üìã Copy Prompt</button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        function togglePrompt(id) {
            document.getElementById(`prompt-${id}`).classList.toggle('open');
        }

        function copyPrompt(text) {
            navigator.clipboard.writeText(text).then(() => showNotification('Copied'));
        }
    </script>
    <!-- FOOTER -->
    <footer style="text-align: center; padding: 2rem 1rem; margin-top: 3rem; border-top: 1px solid var(--card-border);">
        <p style="font-size: 0.75rem; color: var(--text-muted);">THE LANE‚Ñ¢ ‚Äî Canonical v1.0</p>
        <p style="font-size: 0.65rem; color: var(--text-muted); margin-top: 0.75rem;">¬© 2025 THE LANE‚Ñ¢. All rights reserved.<br>Single-user license. No redistribution.</p>
    </footer>

</body>
</html>
